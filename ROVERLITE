<!-- ========================================================= -->
<!-- ===============   MÓDULOS v1-PLUS-ULTRA   ================ -->
<!-- ========================================================= -->
<script type="module">

/* -----------------------------------------------------------
   1. PANEL DE ENERGÍA — estilo Starship
----------------------------------------------------------- */
function energiaV1(){
  const b=document.createElement("div");
  b.id="energiaV1";
  b.style.cssText=`
    position:fixed;right:20px;bottom:320px;width:360px;
    height:140px;background:rgba(0,0,0,.7);z-index:99999;
    border:3px solid #0ff;color:#0ff;font-family:Courier;padding:10px;
  `;
  b.innerHTML="<b>ENERGÍA Ω⁶⁹</b><br><canvas id='engfx' width='340' height='80'></canvas>";
  document.body.appendChild(b);

  const c=document.getElementById("engfx");
  const ctx=c.getContext("2d");
  let lvl=10;

  setInterval(()=>{
    lvl = (lvl + Math.random()*5) % 100;
    ctx.clearRect(0,0,c.width,c.height);
    ctx.fillStyle="#0ff";
    ctx.fillRect(0,30,lvl*3.4,20);
  },500);
}

/* -----------------------------------------------------------
   2. RADAR DOPPLER FICTICIO
----------------------------------------------------------- */
function radarV1(){
  const cv=document.createElement("canvas");
  cv.id="radarv1";
  cv.width=240; cv.height=240;
  cv.style.cssText=`
    position:fixed;right:20px;bottom:480px;border:3px solid #0ff;
    background:rgba(0,0,0,.7);z-index:99999;
  `;
  document.body.appendChild(cv);

  const ctx=cv.getContext("2d");
  let a=0;

  function loop(){
    ctx.clearRect(0,0,240,240);
    ctx.strokeStyle="#0ff";
    ctx.beginPath();
    ctx.arc(120,120,110,0,Math.PI*2);
    ctx.stroke();

    ctx.save();
    ctx.translate(120,120);
    ctx.rotate(a);
    ctx.strokeStyle="#0f0";
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(120,0);
    ctx.stroke();
    ctx.restore();

    a+=0.03;
    requestAnimationFrame(loop);
  }
  loop();
}

/* -----------------------------------------------------------
   3. CAMARA DE “COFIA” (ficticia)
----------------------------------------------------------- */
function camaraV1(){
  const cv=document.createElement("canvas");
  cv.id="camV1";
  cv.width=400; cv.height=240;
  cv.style.cssText=`
    position:fixed;left:20px;top:20px;z-index:99999;
    border:3px solid #0ff;background:#000;
  `;
  document.body.appendChild(cv);
  const ctx=cv.getContext("2d");

  let x=0;
  setInterval(()=>{
    ctx.fillStyle="#000";
    ctx.fillRect(0,0,400,240);
    ctx.fillStyle="#0f0";
    ctx.fillRect(x,120,10,10);
    x+=4; if(x>400)x=0;
    ctx.strokeStyle="#0ff";
    ctx.strokeText("CAMARA COFIA — v1-PLUS-ULTRA",10,20);
  },60);
}

/* -----------------------------------------------------------
   4. IA DE MISIÓN — Panel interactivo
----------------------------------------------------------- */
function iaV1(){
  const d=document.createElement("div");
  d.id="iaV1";
  d.style.cssText=`
    position:fixed;left:50%;bottom:20px;transform:translateX(-50%);
    width:600px;background:rgba(0,0,0,.75);border:3px solid #0ff;
    color:#0ff;font-family:Courier;padding:20px;z-index:99999;
  `;
  d.innerHTML=`
    <b>IA MISIÓN Ω⁶⁹</b><br><br>
    <input id="iaInput" placeholder="Escribe comando…" 
      style="width:100%;padding:6px;background:#000;border:1px solid #0ff;color:#0ff;font-family:Courier">
    <div id="iaOut" style="margin-top:10px;height:120px;overflow:auto;font-size:12px"></div>
  `;
  document.body.appendChild(d);

  const input=document.getElementById("iaInput");
  const out=document.getElementById("iaOut");

  const respuestas={
    "estado":"Telemetría estable. Cadena del barrio íntegra.",
    "saludo":"Hola barrio, aquí IA ω69.",
    "mision":"Protocolo ficticio de misión ejecutándose.",
    "hora":()=> "Hora local: "+new Date().toLocaleTimeString(),
    "ayuda":"Comandos: estado, saludo, mision, hora, energia, radar"
  };

  input.addEventListener("keydown",e=>{
    if(e.key==="Enter"){
      const v=input.value.trim().toLowerCase();
      input.value="";
      let r=respuestas[v];
      if(typeof r==="function") r=r();
      if(!r) r="Comando no reconocido.";
      const p=document.createElement("div");
      p.textContent="> "+r;
      out.appendChild(p);
      out.scrollTop=out.scrollHeight;
    }
  });
}

/* -----------------------------------------------------------
   5. TECLAS ESPECIALES — "MODO BARRIO"
----------------------------------------------------------- */
function teclasV1(){
  window.addEventListener("keydown",e=>{
    if(e.altKey && e.key.toLowerCase()==="b"){
      alertaV1("MODO BARRIO ACTIVADO");
      document.body.style.filter="invert(1)";
      setTimeout(()=>document.body.style.filter="invert(0)",1500);
    }
  });
}

/* -----------------------------------------------------------
   6. ALERTA FLOTANTE (ya existe en v1-PLUS, se expande)
----------------------------------------------------------- */
function alertaV1(text){
  const d=document.createElement("div");
  d.style.cssText=`
    position:fixed;top:80px;right:50px;background:#ff0;color:#000;
    padding:10px 20px;border:3px solid #000;font-family:Courier;
    z-index:999999;font-size:14px;animation:fade2 4s forwards;
  `;
  d.textContent=text;
  document.body.appendChild(d);

  const s=document.createElement("style");
  s.textContent=`
    @keyframes fade2{
      0%{opacity:1}
      80%{opacity:1}
      100%{opacity:0;transform:translateY(-30px)}
    }
  `;
  document.head.appendChild(s);
}

/* -----------------------------------------------------------
   INIT v1-PLUS-ULTRA
----------------------------------------------------------- */
window.addEventListener("load", ()=>{
  energiaV1();
  radarV1();
  camaraV1();
  iaV1();
  teclasV1();
  setTimeout(()=>alertaV1("v1-PLUS-ULTRA listo"),1200);
});

</script>
