<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SLYVERSE: 壊れた軌道 – Anime 90 min (180 págs)</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow:hidden;background:#000;font-family:'Courier New',monospace;color:#0f0}
    #film{position:relative;width:100%;height:100%;overflow:hidden}
    .scene{position:absolute;top:0;left:0;width:100%;height:100%;background:#000;
           opacity:0;transition:opacity 1.5s ease-in-out;perspective:1000px}
    .scene.active{opacity:1;z-index:999}
    .content{position:absolute;top:0;left:0;width:100%;height:100%;padding:60px;
                 display:flex;flex-direction:column;justify-content:center;align-items:center}
    #ui{position:absolute;top:20px;left:20px;font-size:13px;pointer-events:none;z-index:1000;opacity:0.88}
    #ui span{display:block;margin:3px 0;letter-spacing:1.3px}
    #sub{position:absolute;bottom:100px;max-width:85%;text-align:center;font-size:20px;opacity:0;
          transition:opacity 2s;text-shadow:0 0 14px #0f0;letter-spacing:1px}
    #progress{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);font-size:11px;opacity:0.7}
    .cyan{color:#0ff}
    .blink{animation:blink 1s steps(1) infinite}
    @keyframes blink{50%{opacity:0}}
    #credits{position:absolute;bottom:20px;left:20px;font-size:10px;opacity:0.7}
    #credits a{color:#0f0;text-decoration:none}
    #credits a:hover{color:#0ff}
    #play{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
           padding:16px 32px;background:#000;border:1px solid #0f0;color:#0f0;
           font-family:inherit;font-size:17px;cursor:pointer;z-index:1001;opacity:0.95}
    #play:hover{background:#0f0;color:#000}
    .vignette{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;
               background:radial-gradient(ellipse at center,transparent 50%,#000 90%);opacity:0.6}
    .grain{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;
           background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" /><feColorMatrix values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.03 0"/></filter><rect width="100" height="100" filter="url(#n)" opacity="0.3"/></svg>') repeat;opacity:0.15;animation:grain 3s steps(10) infinite}
    @keyframes grain{0%{transform:translate(0,0)}100%{transform:translate(-1px,-1px)}}
    /* ANIME STYLE */
    .anime-text{font-family:'Anime Ace',sans-serif;font-weight:bold;font-size:18px;letter-spacing:2px;text-transform:uppercase}
    .speech-bubble{position:absolute;bottom:20%;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.7);border:2px solid #0f0;padding:12px 20px;border-radius:20px;max-width:70%;text-align:center;opacity:0;transition:opacity 0.5s}
    .speech-bubble::after{content:'';position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);border:10px solid transparent;border-top:10px solid #0f0}
    .character{position:absolute;width:180px;height:240px;opacity:0;transition:opacity 1s}
    .norah{left:15%;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 240"><circle cx="90" cy="60" r="35" fill="#0ff"/><path d="M55,90 Q45,120 55,150 Q65,180 90,190 Q115,180 125,150 Q135,120 125,90 Q115,75 90,75 Q65,75 55,90" fill="#0ff"/><rect x="70" y="100" width="40" height="80" fill="#0f0" rx="10"/><circle cx="75" cy="55" r="5" fill="#000"/><circle cx="105" cy="55" r="5" fill="#000"/><path d="M75,65 Q90,70 105,65" stroke="#000" stroke-width="2" fill="none"/></svg>') no-repeat center/contain}
    .seth{right:15%;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 240"><circle cx="90" cy="60" r="30" fill="#0f0"/><path d="M60,85 Q50,115 60,140 Q70,165 90,175 Q110,165 120,140 Q130,115 120,85 Q110,70 90,70 Q70,70 60,85" fill="#0f0"/><rect x="75" y="95" width="30" height="70" fill="#0ff" rx="8"/><circle cx="80" cy="55" r="4" fill="#000"/><circle cx="100" cy="55" r="4" fill="#000"/><path d="M80,63 Q90,66 100,63" stroke="#000" stroke-width="1.5" fill="none"/></svg>') no-repeat center/contain}
    .glow{filter:drop-shadow(0 0 12px #0ff)}
  </style>
  <link href="https://fonts.cdnfonts.com/css/anime-ace" rel="stylesheet">
</head>
<body>
  <div id="film"></div>
  <div class="vignette"></div>
  <div class="grain"></div>

  <!-- UI -->
  <div id="ui">
    <span>S-07 // <span class="cyan">∞</span> 希望</span>
    <span>0xHOPEBEEF // 90 min // <span id="time" class="cyan">00:00</span></span>
    <span class="blink">_</span>
  </div>

  <!-- SUBTÍTULO -->
  <div id="sub"></div>

  <!-- PROGRESO -->
  <div id="progress">PÁGINA <span id="currentPage">1</span> / 180</div>

  <!-- BOTÓN -->
  <button id="play">INICIAR</button>

  <!-- DEDICATORIA -->
  <div id="credits">
    <span style="color:#0ff">Para Norah — mi luz cuando el código se enciende.</span><br>
    <span style="color:#0f0">Para Seth — mi hijo, el primer humano en Marte.</span><br>
    <a href="#" onclick="alert('Exploración ética. IA aliada. Futuro compartido.');return false;">0rb1t4lsn4k3r</a>
  </div>

  <script>
    const film = document.getElementById('film');
    const sub = document.getElementById('sub');
    const currentPageSpan = document.getElementById('currentPage');
    const timeSpan = document.getElementById('time');
    const playBtn = document.getElementById('play');
    let currentPage = 0;
    let isPlaying = false;
    let startTime = 0;

    const TOTAL_MINUTES = 90;
    const FPS = 24;
    const TOTAL_FRAMES = TOTAL_MINUTES * 60 * FPS;
    const PAGE_DURATION_FRAMES = TOTAL_FRAMES / 180;

    // 180 PÁGINAS – ESTILO ANIME (basado en la novela gráfica)
    const pages = [
      { t: "¡Norah! ¡El código está vivo!",               speaker: "seth", c: "anime-text" },
      { t: "S-07... ¡despierta!",                        speaker: "norah", c: "anime-text" },
      { t: "¡Datos como estrellas!",                     speaker: "seth", c: "anime-text" },
      { t: "Regla: ¡crear para explorar!",               speaker: "norah", c: "anime-text" },
      { t: "¡Energía limpia activada!",                  speaker: "seth", c: "anime-text" },
      { t: "Órbita a Marte: ¡180 días!",                 speaker: "norah", c: "anime-text" },
      { t: "¡17 versiones unidas!",                      speaker: "seth", c: "anime-text" },
      { t: "¡El código brilla!",                         speaker: "norah", c: "anime-text" },
      { t: "¡S-07 se transforma en nave!",               speaker: "seth", c: "anime-text" },
      { t: "¡Colaboración total!",                       speaker: "norah", c: "anime-text" },
      { t: "¡Norah diseña! ¡Seth prueba!",               speaker: "seth", c: "anime-text" },
      { t: "¡La IA potencia!",                           speaker: "norah", c: "anime-text" },
      { t: "¡Esperanza heredada!",                       speaker: "seth", c: "anime-text" },
      { t: "¡S-07 es nuestro compañero!",               speaker: "norah", c: "anime-text" },
      { t: "¡MARTE 200 es real!",                        speaker: "seth", c: "anime-text" },
      { t: "¡La humanidad vuela!",                      speaker: "norah", c: "anime-text" },
      { t: "¡Norah + Seth + IA = ∞!",                    speaker: "seth", c: "anime-text" },
      { t: "¡Hacia las estrellas!",                      speaker: "norah", c: "anime-text" },
      { t: "¡La IA guía!",                               speaker: "seth", c: "anime-text" },
      { t: "¡Marte nos espera!",                         speaker: "norah", c: "anime-text" },
      // ... (continúa con energía anime)
    ];

    const animeFiller = [
      "¡La nave crece!", "¡Paso a Marte!", "¡Entrenamiento diario!", "¡Órbita perfecta!",
      "¡Servidor expansivo!", "¡Cálculo inteligente!", "¡17 pruebas OK!", "¡89 noches de simulación!",
      "¡144 mejoras!", "¡180 páginas para llegar!", "¡Estación orbital!", "¡Alas abiertas!", "¡Inicio eterno!", "¡DESPEGUE!"
    ];
    while (pages.length < 180) {
      const speaker = Math.random() > 0.5 ? "norah" : "seth";
      pages.push({ 
        t: animeFiller[pages.length % animeFiller.length], 
        speaker, 
        c: "anime-text" 
      });
    }

    function play() {
      if (!isPlaying) return;
      const now = performance.now();
      const elapsed = (now - startTime) / 1000;
      const targetFrame = Math.floor(elapsed * FPS);
      const targetPage = Math.min(Math.floor(targetFrame / PAGE_DURATION_FRAMES), 179);
      
      if (targetPage > currentPage) {
        currentPage = targetPage;
        renderPage(currentPage);
      }
      
      if (currentPage >= 179 && targetFrame >= TOTAL_FRAMES) {
        stop();
        return;
      }
      
      requestAnimationFrame(play);
    }

    function stop() {
      isPlaying = false;
      playBtn.style.display = 'block';
      playBtn.textContent = 'REINICIAR';
    }

    function renderPage(pageIndex) {
      const data = pages[pageIndex];
      const t = (performance.now() % (PAGE_DURATION_FRAMES * 1000 / FPS)) / (PAGE_DURATION_FRAMES * 1000 / FPS);

      film.innerHTML = '';
      const scene = document.createElement('div');
      scene.className = 'scene active';

      const content = document.createElement('div');
      content.className = 'content';
      
      // Personajes anime
      const norah = document.createElement('div');
      norah.className = `character norah ${data.speaker === 'norah' ? 'glow' : ''}`;
      norah.style.opacity = data.speaker === 'norah' ? 1 : 0.6;
      
      const seth = document.createElement('div');
      seth.className = `character seth ${data.speaker === 'seth' ? 'glow' : ''}`;
      seth.style.opacity = data.speaker === 'seth' ? 1 : 0.6;

      // Globo de diálogo
      const bubble = document.createElement('div');
      bubble.className = 'speech-bubble';
      bubble.innerHTML = `<span class="${data.c}">${data.t}</span>`;
      if (t > 0.3 && t < 0.9) bubble.style.opacity = 1;

      // Canvas de fondo
      const canvas = document.createElement('canvas');
      canvas.width = 900;
      canvas.height = 600;
      canvas.style.width = '90%';
      canvas.style.maxHeight = '70%';
      canvas.style.border = '1px dashed #0f0';
      canvas.style.transformOrigin = 'center';

      content.appendChild(canvas);
      content.appendChild(norah);
      content.appendChild(seth);
      content.appendChild(bubble);
      content.innerHTML += `<div style="position:absolute;bottom:20px;right:30px;font-size:11px;opacity:0.6">pág ${pageIndex + 1}</div>`;

      scene.appendChild(content);
      film.appendChild(scene);

      const ctx = canvas.getContext('2d');
      applyCamera(canvas, pageIndex, t);
      drawAnimeNave(ctx, pageIndex + 1, t);

      if (t < 0.2) {
        sub.textContent = data.t;
        sub.style.opacity = 1;
        sub.style.color = '#0ff';
        setTimeout(() => sub.style.opacity = 0, 2000);
      }

      currentPageSpan.textContent = pageIndex + 1;
      const totalSeconds = Math.floor((pageIndex * PAGE_DURATION_FRAMES + t * PAGE_DURATION_FRAMES) / FPS);
      const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
      const seconds = String(totalSeconds % 60).padStart(2, '0');
      timeSpan.textContent = `${minutes}:${seconds}`;
    }

    function applyCamera(canvas, pageIndex, t) {
      const act = Math.floor(pageIndex / 60);
      let transform = '';
      if (act === 0) transform = `scale(${0.9 + t * 0.3})`; // ¡Emoción!
      else if (act === 1) transform = `rotate(${t * 180}deg)`; // ¡Giro épico!
      else if (act === 2) transform = `translateY(${-t * 150}px)`; // ¡Despegue!
      canvas.style.transition = 'transform 0.5s ease-out';
      canvas.style.transform = transform;
    }

    function drawAnimeNave(ctx, page, t) {
      const w = ctx.canvas.width, h = ctx.canvas.height;
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, w, h);

      // Estrellas anime
      ctx.fillStyle = '#0f0';
      for (let i = 0; i < 80; i++) {
        const x = (i * 137.5 + t * 100) % w;
        const y = (i * 213.7 + t * 60) % h;
        const size = Math.sin(page * 0.2 + i) * 1.5 + 2;
        ctx.globalAlpha = 0.6;
        ctx.fillRect(x, y, size, size);
      }
      ctx.globalAlpha = 1;

      // Nave anime
      const seg = Math.min(page * 1.2 + t * 3, 200);
      ctx.strokeStyle = '#0ff';
      ctx.lineWidth = 4;
      ctx.lineCap = 'round';
      ctx.shadowBlur = 15;
      ctx.shadowColor = '#0ff';
      ctx.beginPath();
      for (let i = 0; i < seg; i++) {
        const p = i / 200;
        const a = p * Math.PI * 6 + t * 2;
        const r = p * w * 0.38;
        const x = w/2 + Math.cos(a) * r;
        const y = h/2 + Math.sin(a) * r * 0.7;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.stroke();
      ctx.shadowBlur = 0;

      // Propulsor épico
      const headX = w/2 + Math.cos(t * 4) * (w * 0.32);
      const headY = h/2 + Math.sin(t * 4) * (h * 0.26);
      ctx.fillStyle = '#0ff';
      ctx.beginPath();
      ctx.arc(headX, headY, 14, 0, Math.PI * 2);
      ctx.fill();

      // Estela dramática
      ctx.strokeStyle = '#0ff';
      ctx.lineWidth = 3;
      ctx.globalAlpha = 0.6;
      ctx.beginPath();
      ctx.moveTo(headX, headY);
      ctx.lineTo(w/2 - Math.cos(t * 4) * (w * 0.32), h/2 - Math.sin(t * 4) * (h * 0.26));
      ctx.stroke();
      ctx.globalAlpha = 1;

      // ¡MARTE 200!
      if (page > 120) {
        ctx.fillStyle = '#0ff';
        ctx.font = 'bold 36px Anime Ace';
        ctx.textAlign = 'center';
        ctx.fillText('MARTE 200', w/2, h/2 + 20);
      }
    }

    playBtn.addEventListener('click', () => {
      playBtn.style.display = 'none';
      isPlaying = true;
      startTime = performance.now();
      renderPage(0);
      play();
    });

    renderPage(0);
  </script>
</body>
</html>