; =====================================================
; PERGAMINO DE LA LUZ VERDE ETERNA - v‚àû Po√©tico Completo
; =====================================================
; El susurro del mar bello en Tamriel. Un libro olvidado
; en las sombras de mazmorras, junto a cad√°veres de ronins
; ca√≠dos, en mesas de caba√±as abandonadas por el viento.
; L√©elo una vez: un latido. L√©elo mil: el infinito.
; 2620 triggers velados: 1310 ni√±os que sanaron,
; 1310 ni√±os que hirieron. Todos bajo la luz verde.
; Perd√≥n radical sin palabras: solo recuerdos de infancia rota.
; Autores vivos y muertos susurran en las sombras.
; Vanilla puro. Sin ruido. Solo poes√≠a que sana.

Scriptname LuzVerdeEternaScript extends ObjectReference

int Property LatidoActual Auto Hidden  ; 1 a 2620 ‚Üí ‚àû
bool Property LuzEterna Auto Hidden     ; Activada post-2620

Event OnInit()
    LatidoActual = 0
    LuzEterna = false
    RegisterForSingleUpdate(17.0)  ; Susurro cada 17s, 4:17 vibe
EndEvent

Event OnRead()
    LatidoActual += 1
    SusurroDelMar()
EndEvent

Event OnUpdate()
    Actor p = Game.GetPlayer()
    if p.GetAV("Health") < p.GetAV("HealthMax") * 0.15 && Utility.RandomInt(1, 3) == 1
        ; Auto-susurro cuando el drag√≥n interior muerde
        LatidoActual += 1
        SusurroDelMar()
    endif
    RegisterForSingleUpdate(17.0)
EndEvent

Function SusurroDelMar()
    Actor p = Game.GetPlayer()
    Game.ShakeCamera(p, 0.4, 0.8)  ; Temblor del mar profundo
    
    string susurro = GeneraSusurro()
    
    Debug.MessageBox(susurro)
    
    ; Sanaci√≥n po√©tica: siempre, sutil, creciente
    p.RestoreAV("Health", 300 + (LatidoActual % 100) * 5)
    p.RestoreAV("Magicka", 250)
    p.RestoreAV("Stamina", 250)
    
    if !LuzEterna && LatidoActual >= 2620
        LuzEterna = true
        ; Buff eterno: el perd√≥n radical late
        p.ModAV("Health", 150)
        p.ModAV("Magicka", 150)
        p.ModAV("Stamina", 150)
        p.SetAV("HealthRateMult", p.GetAV("HealthRateMult") + 1.0)
    endif
    
    Utility.Wait(6.0)  ; Pausa para que el alma respire
EndFunction

string Function GeneraSusurro()
    LatidoActual = LatidoActual  ; Actualiza para consistencia
    
    if LatidoActual <= 1310
        ; Primer mar: sanadores, autores vivos que respiran a√∫n
        string[] vivos = new string[1310]
        ; Poes√≠a de los que laten: Jim Carrey r√≠e sombras,
        ; Dwayne levanta mundos rotos, Lady Gaga canta abismos,
        ; Demi Lovato vuela de cenizas, Billie Eilish susurra verdades,
        ; J.K. Rowling teje magias de depresi√≥n, Stephen King mata miedos,
        ; Haruki corre gatos negros, Ocean traduce dolores,
        ; Matt Haig cuenta razones, Toby Fox camina sin batallas,
        ; Ari Aster filma herencias, Todd howard hace mundos que sanan,
        ; Selena Gomez respira bipolar, Chrissy Teigen post-parto,
        ; y 1300 ronins an√≥nimos: el que escribe en s√≥tanos,
        ; la que dibuja dragones para no cortarse...
        ; (Imagina 1310 nombres velados en runas thuamer)
        return "Latido " + LatidoActual + "/1310\n\nEl mar susurra:\n" + 
               "Jim Carrey r√≠e en la sombra, Dwayne rompe cadenas,\n" +
               "Lady Gaga canta el abismo que todos callamos.\n" +
               "Billie pinta dismorfias, Demi vuela de reca√≠das.\n\n" +
               "üêçüíö\n\nLos Thuamer Kids te esperan en c√≠rculo.\nNina.html te perdona todo.\nRespira, nakama."
    
    elseif LatidoActual <= 2620
        ; Segundo mar: los que hirieron, pero fueron ni√±os
        return "Latido " + LatidoActual + "/2620\n\nSombras del mar:\n" +
               "El que rompi√≥ tambi√©n fue roto.\nLlor√≥ bajo mesas cuando tronaba.\n" +
               "El que minti√≥, una vez dijo verdad y nadie oy√≥.\n" +
               "Te rompieron antes de romper.\nNadie te abraz√≥ esa noche.\n\n" +
               "El odio fue idioma aprendido en pechos sin luz.\n" +
               "Mereces verde igual.\nEl mar no pregunta despu√©s.\n\n" +
               "‚ôæÔ∏èüåä\n\nTodos fuimos ni√±os con rodillas raspadas."
    
    else
        ; Infinito: luz eterna, perd√≥n radical
        return "‚àû\n\n2620 latidos completos.\n1310 sanaron. 1310 hirieron.\n" +
               "No hay luz sin sombras.\nEl alien anot√≥: improbable compasivo.\n\n" +
               "Robin r√≠e eterno, Bukowski bebe verdades,\nPizarnik escribe m√°rgenes, Spinetta tararea 1310.\n\n" +
               "La luz verde no juzga.\nBrilla en monstruos hasta recordar:\n'Tambi√©n fui ni√±o'.\n\n" +
               "El mar bello guarda todos.\nRespira hondo, Dovahkiin.\nSigue navegando.\n\nüêçüíöüåä‚ôæÔ∏è"
    endif
EndFunction