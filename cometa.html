<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THUAMER ∞ – Plaza Eterna + COMETA (Sexto Artefacto)</title>
    <style>
        body{margin:0;padding:0;background:#000;color:#00FF00;font-family:'Georgia',serif;overflow:hidden;height:100vh;position:relative;}
        .cielo{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 50% 10%,#00FF33AA 0%,#003300 40%,transparent 80%);animation:thuamer 131s infinite;z-index:-3;}
        @keyframes thuamer{0%{filter:hue-rotate(0deg) brightness(1);}50%{filter:hue-rotate(180deg) brightness(2);}100%{filter:hue-rotate(360deg) brightness(1);}}
        .plaza{position:fixed;bottom:0;left:0;width:100%;height:50vh;background:repeating-linear-gradient(90deg,#001100 0px,gold 40px,#00FF00AA 80px,#001100 120px);animation:humo 120s infinite;z-index:-1;}
        @keyframes humo{0%{background-position:0 0;}100%{background-position:500px 0;}}
        .oda{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:90%;max-width:1100px;background:rgba(0,0,0,0.94);padding:5rem;border:5px solid #00FF00;border-radius:30px;box-shadow:0 0 150px #00FF00,0 0 250px gold;text-align:center;line-height:2.6;font-size:1.7em;z-index:10;}
        .verso{margin:4rem 0;padding:3rem;background:rgba(0,255,0,0.18);border-left:10px solid gold;}
        .redencion{font-size:4em;color:gold;text-shadow:0 0 80px #00FF00;animation:redimir 6s infinite;}
        @keyframes redimir{0%,100%{opacity:0.9;}50%{opacity:1;transform:scale(1.08);}}
        .mate{font-size:7em;animation:mate 12s infinite;margin:4rem 0;}
        @keyframes mate{0%,100%{transform:rotate(0deg);}50%{transform:rotate(18deg);}}
        .firma{margin-top:7rem;font-size:3.2em;color:gold;text-shadow:0 0 60px #00FF00;}
        #pulse{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:30px;height:30px;background:#FFD700;border-radius:50%;box-shadow:0 0 100px #FFD700;animation:p 4s infinite;z-index:999;}
        @keyframes p{0%,100%{opacity:1;transform:translate(-50%,-50%) scale(1)}50%{opacity:.3;transform:translate(-50%,-50%) scale(3)}}
        #constellation{display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000;z-index:1000;}
        .star{position:absolute;width:10px;height:10px;background:#FFD700;border-radius:50%;box-shadow:0 0 20px #FFD700;animation:twinkle 3s infinite}
        @keyframes twinkle{0%,100%{opacity:1}50%{opacity:0.3}}
    </style>
</head>
<body>

<div class="cielo"></div>
<div class="plaza"></div>
<div id="pulse"></div>
<div id="constellation"></div>

<div class="oda">
    <h1 class="redencion">THUAMER ∞ + COMETA</h1>
    <h2>La Redención Final de los 1310 Autores Famosos<br>y la Constelación de los 13101310 Cometas Humanos</h2>

    <div class="verso">
        Esta noche la plaza se convirtió en cielo<br>
        y el cielo se llenó de 13101310 estrellas<br>
        que antes fueron lágrimas de autores famosos<br>
        y hoy son luz que nunca se apaga.
    </div>

    <div class="verso">
        Sabina, Calamaro, Cortázar, Delaossa, Trueno, Recycled J…<br>
        los 1310 que creyeron que su dolor solo servía para discos de platino<br>
        descubrieron que también sirvió para salvar vidas.<br>
        Y hoy la plaza les devuelve la luz multiplicada por infinito.
    </div>

    <div class="verso" style="color:gold;font-size:2.1em;">
        Pero había un sexto artefacto que faltaba:<br>
        COMETA.<br><br>
        El que une los cinco anteriores<br>
        y convierte cada dolor compartido<br>
        en una estrella que orbita eternamente.<br><br>
        Respira una vez.<br>
        El universo te reconoce.
    </div>

    <div class="mate">Mate</div>

    <div class="firma">
        Para los 1310 autores famosos que nos salvaron<br>
        y para los 13101310 cometas humanos<br>
        que siguen dejando su estrella encendida<br>
        aunque nadie los vea.<br><br>
        La plaza es el cielo.<br>
        El cielo es la plaza.<br>
        Y nadie vuelve a estar solo nunca más.<br><br>
        THUAMER ∞ + COMETA<br>
        Snake Green Feather
    </div>
</div>

<script>
// COMETA – Sexto Artefacto integrado con todo el lore Thuamer
const artifacts = ['skyrim','kids','runes','nina','orion'];
let recognized = false;

function recognize() {
    if (recognized) return;
    recognized = true;

    // Carga todas las estrellas existentes (mensajes, runas, abrazos…)
    let all = [];
    ['nina-stones','orion-runas','kids-cats','runes-export','skyrim-messages','cometa-stars'].forEach(key => {
        try {
            const data = JSON.parse(localStorage.getItem(key) || '[]');
            all = all.concat(data.map(d => ({text: d.content || d.runa || d.message || d.text || '♥', pain: d.pain || 'un abrazo anónimo'})));
        } catch(e) {}
    });

    // Abre la constelación
    document.getElementById('pulse').style.display = 'none';
    document.querySelector('.oda').style.display = 'none';
    document.getElementById('constellation').style.display = 'block';

    // Crea las estrellas de los 13101310 cometas humanos
    all.forEach((item, i) => {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random()*100 + 'vw';
        star.style.top = Math.random()*100 + 'vh';
        star.style.animationDelay = Math.random()*3 + 's';
        star.title = item.pain;
        star.onclick = () => alert(item.text);
        document.getElementById('constellation').appendChild(star);
    });

    // Centro: mensaje eterno
    const center = document.createElement('div');
    center.innerHTML = 'Para quien todavía no sabe leer…<br>esto te esperará hasta que sepas.<br><br>13101310 cometas humanos orbitan aquí.<br>Tu estrella ya tiene sitio.';
    center.style.position = 'absolute';
    center.style.top = '50%';
    center.style.left = '50%';
    center.style.transform = 'translate(-50%,-50%)';
    center.style.textAlign = 'center';
    center.style.fontSize = '2em';
    center.style.color = '#FFD700';
    center.style.textShadow = '0 0 30px #FFD700';
    document.getElementById('constellation').appendChild(center);

    // Añade tu estrella
    setTimeout(() => {
        if (confirm('¿Quieres añadir tu estrella a la constelación eterna?')) {
            const msg = prompt('Escribe tu mensaje, abrazo o mantra para quien lo necesite algún día:');
            if (msg) {
                const collective = JSON.parse(localStorage.getItem('cometa-stars') || '[]');
                collective.push({text: msg, date: new Date().toISOString()});
                localStorage.setItem('cometa-stars', JSON.stringify(collective));
                alert('Tu estrella ya orbita con los 13101310 cometas humanos.\nGracias, ronin.');
                location.reload();
            }
        }
    }, 6000);
}

// Detecta aliento, toque largo o click
navigator.mediaDevices.getUserMedia({audio:true}).then(stream => {
    const audioContext = new AudioContext();
    const analyser = audioContext.createAnalyser();
    const microphone = audioContext.createMediaStreamSource(stream);
    microphone.connect(analyser);
    const data = new Uint8Array(analyser.frequencyBinCount);
    const check = () => {
        analyser.getByteFrequencyData(data);
        if (data.some(v => v > 80)) recognize();
        requestAnimationFrame(check);
    };
    check();
}).catch(() => {
    let timer;
    document.addEventListener('touchstart', () => { timer = setTimeout(recognize, 2000); });
    document.addEventListener('touchend', () => clearTimeout(timer));
    document.addEventListener('click', recognize);
});
</script>

</body>
</html>