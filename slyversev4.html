<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SLYVERSE v4 – Versión Educativa</title>
  <style>
    /* ==== ESTILOS BÁSICOS ==== */
    body { margin:0; padding:0; font-family:Arial, sans-serif; background:#111; color:#eee; }
    header, footer { background:#222; padding:1rem; text-align:center; }
    nav { background:#333; padding:0.5rem; display:flex; justify-content:center; flex-wrap:wrap; }
    nav a { color:#0f0; margin:0 1rem; text-decoration:none; font-weight:bold; }
    nav a:hover { text-decoration:underline; }
    main { padding:2rem; max-width:960px; margin:auto; }
    section { margin-bottom:3rem; }
    h1, h2, h3 { color:#0f0; }
    pre { background:#222; padding:1rem; overflow:auto; border-left:4px solid #0f0; border-radius:4px; }
    .explicacion { background:#1a1a1a; padding:1rem; border-radius:8px; margin-top:1rem; }
    .comentario { color:#888; font-style:italic; }
    footer { font-size:0.8rem; color:#666; margin-top:2rem; }
    canvas { display:block; width:100%; height:100vh; background:#000; }
    /* ==== ANIMACIONES DIDÁCTICAS ==== */
    @keyframes pulse { 0%{opacity:0.6} 50%{opacity:1} 100%{opacity:0.6} }
    .destacado { animation:pulse 2s infinite; }
    /* ==== RESPONSIVE ==== */
    @media (max-width:600px) {
      nav { flex-direction:column; text-align:center; }
      nav a { margin:0.5rem 0; }
    }
  </style>
</head>
<body>

<header>
  <h1>SLYVERSE v4 – <span class="destacado">Versión Educativa</span></h1>
  <p>Aprende HTML, CSS y JavaScript paso a paso con comentarios explicativos.</p>
</header>

<nav>
  <a href="#intro">Introducción</a>
  <a href="#estructura">Estructura HTML</a>
  <a href="#estilos">CSS Básico</a>
  <a href="#interactividad">JavaScript</a>
  <a href="#canvas">Canvas 3D</a>
  <a href="#ejercicios">Ejercicios</a>
</nav>

<main>

<!-- ============================================= -->
<!-- 1. INTRODUCCIÓN                               -->
<!-- ============================================= -->
<section id="intro">
  <h2>1. ¿Qué es SLYVERSE?</h2>
  <p>
    SLYVERSE es una <strong>demostración interactiva</strong> de gráficos 3D en el navegador usando únicamente
    <code>&lt;canvas&gt;</code>, HTML, CSS y JavaScript <strong>sin librerías externas</strong>.
  </p>
  <div class="explicacion">
    <p><strong>Objetivo educativo:</strong> Entender cómo se renderiza un mundo 3D en 2D sin WebGL.</p>
    <ul>
      <li>Proyección perspectiva</li>
      <li>Transformaciones de coordenadas</li>
      <li>Renderizado de polígonos (triángulos)</li>
      <li>Control de cámara con ratón</li>
    </ul>
  </div>
</section>

<!-- ============================================= -->
<!-- 2. ESTRUCTURA HTML BÁSICA                     -->
<!-- ============================================= -->
<section id="estructura">
  <h2>2. Estructura HTML</h2>
  <p>Todo documento HTML comienza con <code>&lt;!DOCTYPE html&gt;</code> y la etiqueta raíz <code>&lt;html&gt;</code>.</p>

  <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="es"&gt;
  &lt;head&gt; ... &lt;/head&gt;
  &lt;body&gt; ... &lt;/body&gt;
&lt;/html&gt;</code></pre>

  <div class="explicacion">
    <p><code>lang="es"</code> indica que el contenido está en español → mejora accesibilidad y SEO.
    <br><code>&lt;meta charset="UTF-8"&gt;</code> permite caracteres especiales (ñ, á, etc.).
  </div>

  <h3>Nuestra estructura</h3>
  <pre><code>&lt;header&gt;...&lt;/header&gt;
&lt;nav&gt;...&lt;/nav&gt;
&lt;main&gt;
  &lt;section id="intro"&gt;...&lt;/section&gt;
  ...
&lt;/main&gt;
&lt;canvas id="c"&gt;&lt;/canvas&gt;</code></pre>

  <div class="explicacion">
    <p><strong>Semántica HTML5:</strong></p>
    <ul>
      <li><code>&lt;header&gt;</code>: cabecera de página o sección.</li>
      <li><code>&lt;nav&gt;</code>: menú de navegación.</li>
      <li><code>&lt;main&gt;</code>: contenido principal (accesible con lectores de pantalla).</li>
      <li><code>&lt;section&gt;</code>: bloque temático con <code>id</code> para enlaces internos.</li>
    </ul>
  </div>
</section>

<!-- ============================================= -->
<!-- 3. ESTILOS CSS BÁSICOS                        -->
<!-- ============================================= -->
<section id="estilos">
  <h2>3. CSS: Haciéndolo bonito y responsive</h2>
  <p>Los estilos se colocan dentro de <code>&lt;style&gt;</code> en el <code>&lt;head&gt;</code>.</p>

  <pre><code>body { margin:0; background:#111; color:#eee; font-family:Arial; }
canvas { display:block; width:100%; height:100vh; }</code></pre>

  <div class="explicacion">
    <ul>
      <li><code>margin:0; padding:0;</code> → elimina márgenes por defecto del navegador.</li>
      <li><code>height:100vh;</code> → el canvas ocupa toda la altura de la ventana (<strong>vh</strong> = viewport height).</li>
      <li><code>display:block;</code> → evita espacios extra debajo del canvas.</li>
    </ul>
  </div>

  <h3>Responsive con <code>@media</code></h3>
  <pre><code>@media (max-width:600px) {
  nav { flex-direction:column; }
}</code></pre>

  <div class="explicacion">
    Cuando la pantalla es menor a 600 px, el menú pasa a columna. ¡Adapta tu web a móviles!
  </div>
</section>

<!-- ============================================= -->
<!-- 4. INTERACTIVIDAD CON JAVASCRIPT              -->
<!-- ============================================= -->
<section id="interactividad">
  <h2>4. JavaScript: El cerebro del proyecto</h2>
  <p>Obtenemos el canvas y su contexto 2D:</p>
  <pre><code>const c = document.getElementById('c');
const ctx = c.getContext('2d');</code></pre>

  <div class="explicacion">
    <ul>
      <li><code>getElementById</code> → selecciona el elemento con <code>id="c"</code>.</li>
      <li><code>getContext('2d')</code> → nos da un lienzo para dibujar píxeles.</li>
    </ul>
  </div>

  <h3>Redimensionar el canvas</h3>
  <pre><code>function resize() {
  c.width = innerWidth;
  c.height = innerHeight;
}
window.addEventListener('resize', resize);
resize();</code></pre>

  <div class="explicacion">
    <p>El evento <code>resize</code> se dispara cada vez que cambias el tamaño de la ventana. Llamamos a <code>resize()</code> al inicio para establecer el tamaño correcto.</p>
  </div>
</section>

<!-- ============================================= -->
<!-- 5. RENDERIZADO 3D EN CANVAS                   -->
<!-- ============================================= -->
<section id="canvas">
  <h2>5. Renderizado 3D sin WebGL</h2>
  <p>Convertimos coordenadas 3D → 2D mediante <strong>proyección perspectiva</strong>.</p>

  <pre><code>function project(p) {
  const fov = 500;
  const dist = cam.z - p.z;
  if (dist <= 0) return null;
  const scale = fov / dist;
  return {
    x: (p.x - cam.x) * scale + cw/2,
    y: (p.y - cam.y) * scale + ch/2
  };
}</code></pre>

  <div class="explicacion">
    <p><strong>Fórmula de proyección:</strong></p>
    <p class="comentario">x' = (x - cam.x) × (fov / (cam.z - z)) + centroX</p>
    <p>Cuanto más lejos está un punto (<code>dist</code> grande), más pequeño aparece (<code>scale</code> pequeño).</p>
  </div>

  <h3>Dibujar triángulos</h3>
  <pre><code>function drawTriangle(a, b, c, color) {
  ctx.fillStyle = color;
  ctx.beginPath();
  ctx.moveTo(a.x, a.y);
  ctx.lineTo(b.x, b.y);
  ctx.lineTo(c.x, c.y);
  ctx.closePath();
  ctx.fill();
}</code></pre>

  <div class="explicacion">
    <p>Usamos el <strong>painter’s algorithm</strong>: dibujamos triángulos de atrás hacia adelante para simular profundidad.</p>
  </div>
</section>

<!-- ============================================= -->
<!-- 6. EJERCICIOS PRÁCTICOS                       -->
<!-- ============================================= -->
<section id="ejercicios">
  <h2>6. ¡Manos a la obra! Ejercicios</h2>
  <ol>
    <li><strong>Cambia el FOV:</strong> Modifica la variable <code>fov</code> en la función <code>project</code>. ¿Qué pasa con el campo visual?</li>
    <li><strong>Añade un nuevo cubo:</strong> Duplica el array <code>cubes</code> con distintas coordenadas y colores.</li>
    <li><strong>Rotación automática:</strong> En el bucle de animación, incrementa <code>cube.rotation.y += 0.01;</code>.</li>
    <li><strong>Control con teclado:</strong> Usa <code>keydown</code> para mover la cámara (WASD + QE para subir/bajar).</li>
  </ol>

  <div class="explicacion">
    <p>¡Copia este código en <a href="https://jsfiddle.net" target="_blank">JSFiddle</a> o <a href="https://codepen.io" target="_blank">CodePen</a> y experimenta!</p>
  </div>
</section>

</main>

<canvas id="c"></canvas>

<script>
// ===============================================
// 1. CONFIGURACIÓN INICIAL
// ===============================================
const c = document.getElementById('c');
const ctx = c.getContext('2d');
let cw, ch;

// Redimensionamiento
function resize() {
  c.width = cw = innerWidth;
  c.height = ch = innerHeight;
}
window.addEventListener('resize', resize);
resize();

// ===============================================
// 2. CÁMARA
// ===============================================
const cam = { x:0, y:0, z:-5, rotX:0, rotY:0 };
let mouseDown = false, lastX, lastY;

// Control con ratón
c.addEventListener('mousedown', e => { mouseDown = true; lastX = e.clientX; lastY = e.clientY; });
c.addEventListener('mouseup', () => { mouseDown = false; });
c.addEventListener('mousemove', e => {
  if (!mouseDown) return;
  const dx = e.clientX - lastX;
  const dy = e.clientY - lastY;
  cam.rotY += dx * 0.005;
  cam.rotX += dy * 0.005;
  lastX = e.clientX;
  lastY = e.clientY;
});

// ===============================================
// 3. PROYECCIÓN PERSPECTIVA
// ===============================================
function project(p) {
  const fov = 500;
  const cosY = Math.cos(cam.rotY), sinY = Math.sin(cam.rotY);
  const cosX = Math.cos(cam.rotX), sinX = Math.sin(cam.rotX);

  let dx = p.x - cam.x;
  let dy = p.y - cam.y;
  let dz = p.z - cam.z;

  // Rotación Y
  let tempX = dx * cosY + dz * sinY;
  dz = dz * cosY - dx * sinY;
  dx = tempX;

  // Rotación X
  let tempY = dy * cosX - dz * sinX;
  dz = dy * sinX + dz * cosX;
  dy = tempY;

  if (dz <= 0) return null;

  const scale = fov / dz;
  return {
    x: dx * scale + cw/2,
    y: dy * scale + ch/2
  };
}

// ===============================================
// 4. DEFINICIÓN DE CUBOS
// ===============================================
const cubes = [
  { pos:{x:0,y:0,z:5}, size:1, rotation:{x:0,y:0,z:0}, color:'#0f0' },
  { pos:{x:3,y:-1,z:7}, size:0.8, rotation:{x:0.5,y:0.8,z:0}, color:'#0ff' },
  { pos:{x:-4,y:1,z:6}, size:1.2, rotation:{x:0,y:1.5,z:0}, color:'#f0f' }
];

const cubeVertices = [
  [-1,-1,-1],[ 1,-1,-1],[ 1, 1,-1],[-1, 1,-1],
  [-1,-1, 1],[ 1,-1, 1],[ 1, 1, 1],[-1, 1, 1]
];

const cubeFaces = [
  [0,1,2],[0,2,3], [5,4,7],[5,7,6],
  [4,0,3],[4,3,7], [1,5,6],[1,6,2],
  [4,5,1],[4,1,0], [3,2,6],[3,6,7]
];

// ===============================================
// 5. ROTACIÓN DE PUNTOS
// ===============================================
function rotatePoint(p, rot) {
  let {x, y, z} = p;
  // X
  let cos = Math.cos(rot.x), sin = Math.sin(rot.x);
  let ty = y * cos - z * sin;
  let tz = y * sin + z * cos;
  y = ty; z = tz;
  // Y
  cos = Math.cos(rot.y); sin = Math.sin(rot.y);
  let tx = x * cos + z * sin;
  z = z * cos - x * sin;
  x = tx;
  // Z
  cos = Math.cos(rot.z); sin = Math.sin(rot.z);
  let txx = x * cos - y * sin;
  y = x * sin + y * cos;
  x = txx;
  return {x, y, z};
}

// ===============================================
// 6. DIBUJAR TRIÁNGULO
// ===============================================
function drawTriangle(a, b, c, color) {
  if (!a || !b || !c) return;
  ctx.fillStyle = color;
  ctx.beginPath();
  ctx.moveTo(a.x, a.y);
  ctx.lineTo(b.x, b.y);
  ctx.lineTo(c.x, c.y);
  ctx.closePath();
  ctx.fill();
}

// ===============================================
// 7. BUCLE DE ANIMACIÓN
// ===============================================
function animate() {
  ctx.fillStyle = '#111';
  ctx.fillRect(0, 0, cw, ch);

  const sortedCubes = [...cubes].sort((a, b) => {
    const da = Math.hypot(a.pos.x - cam.x, a.pos.y - cam.y, a.pos.z - cam.z);
    const db = Math.hypot(b.pos.x - cam.x, b.pos.y - cam.y, b.pos.z - cam.z);
    return db - da;
  });

  sortedCubes.forEach((cube, cubeIndex) => {
    const s = cube.size;
    const r = cube.rotation;

    // Rotación automática (ejercicio)
    cube.rotation.y += 0.01;
    cube.rotation.x += 0.005;

    const verts = cubeVertices.map(v => {
      let p = { x: v[0] * s + cube.pos.x, y: v[1] * s + cube.pos.y, z: v[2] * s + cube.pos.z };
      p = rotatePoint(p, r);
      return project(p);
    });

    cubeFaces.forEach((face, i) => {
      const [i1, i2, i3] = face;
      const p1 = verts[i1], p2 = verts[i2], p3 = verts[i3];
      if (!p1 || !p2 || !p3) return;

      // Sombras simples por cara
      const shade = 0.5 + 0.5 * Math.abs((i % 6) - 3) / 3;
      const color = cube.color;
      const r = parseInt(color.slice(1,3), 16) * shade;
      const g = parseInt(color.slice(3,5), 16) * shade;
      const b = parseInt(color.slice(5,7), 16) * shade;
      const shadedColor = `rgb(${r|0},${g|0},${b|0})`;

      drawTriangle(p1, p2, p3, shadedColor);
    });
  });

  requestAnimationFrame(animate);
}

animate();

</script>

<footer>
  <p>© 2025 SLYVERSE Educativo – Hecho con HTML, CSS y JavaScript puro.</p>
</footer>

</body>
</html>