<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>EGO ARENA ∞ v2.0 — THUAMER STUDIOS™</title>
<style>
  body,html{margin:0;overflow:hidden;background:#000;height:100%;cursor:none;font-family:'Courier New',monospace;color:#0f0}
  canvas{display:block}
  #hud,#msg,#crosshair{position:fixed;z-index:999;pointer-events:none}
  #hud{top:15px;left:15px;font:18px monospace;text-shadow:0 0 15px #0f0;letter-spacing:2px}
  #crosshair{top:50%;left:50%;width:32px;height:32px;border:4px solid #0f0;border-radius:50%;box-shadow:0 0 40px #0f0;transform:translate(-50%,-50%);animation:pulse 1.5s infinite}
  #msg{bottom:40px;left:50%;transform:translateX(-50%);font:32px monospace;color:#0ff;text-shadow:0 0 25px #0ff;letter-spacing:3px}
  #loading,#menu,#shop,#gameover{position:fixed;inset:0;background:#000;color:#0f0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:30px;z-index:9999;font-size:32px;text-align:center}
  #menu,#shop,#gameover{background:rgba(0,0,0,0.98)}
  #loading{background:#000}
  h1{font-size:90px;margin:0;color:#0f0;text-shadow:0 0 50px #0f0;animation:glitch 3s infinite}
  @keyframes glitch{0%,100%{text-shadow:0 0 50px #0f0} 10%{text-shadow:-5px 0 #f0f,5px 0 #0ff} 20%{text-shadow:5px 0 #f0f,-5px 0 #0ff}}
  @keyframes pulse{0%,100%{box-shadow:0 0 40px #0f0}50%{box-shadow:0 0 80px #0ff}}
  button{background:#0f0;color:#000;border:none;padding:25px 70px;font-size:30px;cursor:pointer;font-weight:bold;border-radius:12px;transition:0.3s;box-shadow:0 0 30px #0f0;letter-spacing:2px}
  button:hover{background:#0ff;color:#000;transform:scale(1.15);box-shadow:0 0 70px #0ff}
  .skin-btn{background:#00ffff;color:#000;padding:30px;margin:20px;border-radius:25px;font-size:26px;width:400px;transition:0.4s;border:3px solid #0ff;box-shadow:0 0 40px #0ff}
  .skin-btn:hover{background:#00ffff;transform:translateY(-15px);box-shadow:0 0 80px #0fff}
  .premium{color:#ffd700;text-shadow:0 0 20px #ffd700;font-size:32px}
  pre{background:rgba(0,20,0,0.95);padding:30px;border:4px solid #0f0;max-width:90%;box-shadow:0 0 60px #0f0;overflow:auto;font-size:18px}
</style>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/postprocessing/EffectComposer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/postprocessing/RenderPass.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/postprocessing/UnrealBloomPass.js"></script>
<script src="https://www.paypal.com/sdk/js?client-id=AaX9y8z7w6v5u4t3s2r1q0p9o8n7m6l5k4j3i2h1g0f9e8d7c6b5a4&currency=EUR&intent=capture"></script>
</head>
<body>

<div id="loading">
  <h1>EGO ARENA ∞ v2.0</h1>
  <div>THUAMER STUDIOS™ — 2025</div>
  <div id="progress">0%</div>
  <pre>
EGO ARENA ∞ v2.0 — THUAMER STUDIOS™
© 2025 Todos los derechos reservados

Una experiencia idle-cyber-neón definitiva.
Destruye egos infinitos. Absorbe su esencia.
Premium = Auto-kill + x10 + vidas infinitas

Skins 0.49€ — Premium 4.99€
Pago único → ferry420oficial@gmail.com (PayPal)

CLICK O ESPERA. EL EGO SE DESTRUYE SOLO.
  </pre>
</div>

<div id="hud">
  EGOS: <span id="score">0</span> ┃ MULTI: <span id="multi">x1.0</span> ┃ NIVEL: <span id="level">1</span><br>
  <span class="premium" id="status">DEMO</span>
</div>
<div id="crosshair"></div>
<div id="msg"></div>

<div id="menu">
  <h1>EGO ARENA ∞</h1>
  <h2>THUAMER STUDIOS™</h2>
  <p style="font-size:28px;max-width:90%">Destruye egos infinitos.<br>El silencio es la verdadera victoria.</p>
  <div id="paypal-premium"></div>
  <button onclick="startGame()">INICIAR ARENA</button>
  <button onclick="openShop()">TIENDA DE EGOS (0.49€)</button>
</div>

<div id="shop" class="hidden">
  <h1>TIENDA DE EGOS</h1>
  <p><strong>Absorbe su forma. Multiplica el vacío.</strong></p>
  <div id="paypal-void"></div>
  <div id="paypal-glitch"></div>
  <div id="paypal-gold"></div>
  <div style="display:flex;justify-content:center;flex-wrap:wrap;gap:20px;">
    <button class="skin-btn" onclick="applySkin('void')">
      VOID CORE<br><canvas id="preview-void" width="160" height="160"></canvas>
    </button>
    <button class="skin-btn" onclick="applySkin('glitch')">
      GLITCH DEMON<br><canvas id="preview-glitch" width="160" height="160"></canvas>
    </button>
    <button class="skin-btn" onclick="applySkin('gold')">
      GOLDEN EGO<br><canvas id="preview-gold" width="160" height="160"></canvas>
    </button>
  </div>
  <button onclick="closeShop()" style="background:#f00;margin-top:50px">CERRAR</button>
</div>

<div id="gameover" class="hidden">
  <h1 style="color:#f00;font-size:80px">EGO INVENCIBLE</h1>
  <h2>Egos destruidos: <span id="finalScore">0</span></h2>
  <h2>High Score: <span id="highScore">0</span></h2>
  <button onclick="location.reload()">REINICIAR ARENA</button>
</div>

<script>
// =============== EGO ARENA ∞ v2.0 — THUAMER STUDIOS™ ===============
const IS_PREMIUM = localStorage.getItem('ego_premium') === 'true';
let ownedSkins = JSON.parse(localStorage.getItem('ego_skins') || '["default"]');
let currentSkin = ownedSkins[0];
document.getElementById('status').textContent = IS_PREMIUM ? 'PREMIUM ∞' : 'DEMO';

let score = 0, multi = 1, level = 1, lives = IS_PREMIUM ? 999999 : 10;
let highScore = parseInt(localStorage.getItem('ego_high') || '0');
let autoKill = IS_PREMIUM;
let shake = 0;

// PayPal
paypal.Buttons({
  createOrder: (d,a) => a.order.create({purchase_units:[{amount:{value:'4.99'},description:'EGO ARENA ∞ PREMIUM — Auto-kill + ∞ vidas'}]}),
  onApprove: () => {localStorage.setItem('ego_premium','true');alert('PREMIUM ACTIVADO — LOS EGOS SE DESTRUYEN SOLOS');location.reload();}
}).render('#paypal-premium');

const SKINS = {void:'0.49',glitch:'0.49',gold:'0.99'};
['void','glitch','gold'].forEach(s => {
  paypal.Buttons({
    createOrder: (d,a) => a.order.create({purchase_units:[{amount:{value:SKINS[s]},description:`Skin ${s.toUpperCase()} EGO ARENA ∞`}]}),
    onApprove: () => {
      if(!ownedSkins.includes(s)){ownedSkins.push(s);localStorage.setItem('ego_skins',JSON.stringify(ownedSkins));alert(`SKIN ${s.toUpperCase()} ABSORBIDA`);}
    }
  }).render(`#paypal-${s}`);
});

function applySkin(skin){
  if(ownedSkins.includes(skin)){
    currentSkin = skin;
    if(window.player) window.player.setTexture(`ego_${skin}`);
    msg(`EGO ${skin.toUpperCase()} EQUIPADO — +100% PODER`);
  } else msg('COMPRA LA SKIN PRIMERO');
}

// Previews animados con glitch
function drawPreview(skin, id) {
  const canvas = document.getElementById(id);
  const ctx = canvas.getContext('2d');
  let t = 0;
  setInterval(() => {
    ctx.fillStyle = '#000'; ctx.fillRect(0,0,160,160);
    const col = skin === 'void' ? '#000' : skin === 'glitch' ? `hsl(${(t*5)%360},100%,50%)` : '#ffd700';
    ctx.fillStyle = col;
    ctx.fillRect(20,20,120,120);
    ctx.fillStyle = skin === 'void' ? '#0f0' : '#000';
    ctx.font = 'bold 48px Courier';
    ctx.textAlign = 'center';
    ctx.fillText('EGO',80,100);
    if(skin==='glitch' && Math.random()<0.3){
      ctx.fillStyle = '#f0f'; ctx.fillRect(0,Math.random()*160,160,10);
      ctx.fillStyle = '#0ff'; ctx.fillRect(0,Math.random()*160,160,10);
    }
    t++;
  }, 80);
}
['void','glitch','gold'].forEach(s => drawPreview(s, `preview-${s}`));

// THREE.js Post-processing (Bloom + Glitch vibe)
let composer, bloomPass;
const game = new Phaser.Game({
  type: Phaser.WEBGL,
  width: window.innerWidth,
  height: window.innerHeight,
  backgroundColor: '#000011',
  scale: { mode: Phaser.Scale.FIT, autoCenter: Phaser.Scale.CENTER_BOTH },
  physics: { default: 'arcade', arcade: { gravity: { y: 0 } } },
  scene: { preload, create, update },
  postPipeline: true,
  render: { pixelArt: false }
});

function preload(){
  const svg = (c,t) => `data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><circle cx="50" cy="50" r="45" fill="${c}" stroke="#0f0" stroke-width="4"/><text x="50" y="62" font-size="36" text-anchor="middle" fill="#000" font-family="Courier">${t}</text></svg>`)}`;
  this.load.svg('ego_default', svg('#0f0','E'));
  this.load.svg('ego_void', svg('#000','V'));
  this.load.svg('ego_glitch', svg('#ff00ff','G'));
  this.load.svg('ego_gold', svg('#ffd700','O'));
  this.load.svg('particle', svg('#0ff','*'));
}

let player, egos, particles, waveTimer = 0;
function create(){
  // Bloom effect simulado con shaders (Phaser 3 + custom pipeline)
  this.cameras.main.setPostPipeline('bloom');

  player = this.physics.add.sprite(this.scale.width/2, this.scale.height-150, `ego_${currentSkin}`).setScale(3).setDepth(10);
  player.setTint(0x00ff00);
  egos = this.physics.add.group();
  particles = this.add.particles('particle');

  this.input.on('pointerdown', () => {
    multi = Math.min(multi * 1.35, 500);
    shake = 15;
    player.setTint(0x00ffff);
    this.time.delayedCall(150, () => player.clearTint());
    msg(`MULTI x${multi.toFixed(1)}`);
  });

  // Fondo con gradiente neón
  const gfx = this.add.graphics();
  gfx.fillGradientStyle(0x000000, 0x000011, 0x001100, 0x000022, 1);
  gfx.fillRect(0,0,this.scale.width,this.scale.height);
  gfx.setDepth(-1);
}

function update(time, delta){
  waveTimer += delta;
  if(waveTimer > Math.max(300, 2000 / level)){
    spawnWave.call(this);
    waveTimer = 0;
  }

  if(autoKill){
    egos.children.entries.forEach(e => destroyEgo.call(this, player, e));
  }

  // Score idle
  score += multi * delta * (IS_PREMIUM ? 0.15 : 0.06);
  level = Math.floor(score / 1500) + 1;

  // Screen shake
  if(shake > 0){
    this.cameras.main.shake(80, shake * 0.01);
    shake *= 0.9;
  }

  updateUI();
  if(lives <= 0) gameOver();
}

function spawnWave(){
  for(let i = 0; i < level + 3; i++){
    const x = Phaser.Math.Between(100, this.scale.width - 100);
    const y = Phaser.Math.Between(100, this.scale.height - 200);
    const ego = egos.create(x, y, 'ego_default').setScale(1 + Math.random() * 1.5);
    ego.setVelocity(Phaser.Math.Between(-200,200), Phaser.Math.Between(-200,200));
    ego.setBounce(1).setCollideWorldBounds(true);
    ego.setTint(Math.random() < 0.1 ? 0xff00ff : 0x00ff00);
  }
}

function destroyEgo(player, ego){
  score += multi * level * 15;
  lives--;

  const emitter = particles.createEmitter({
    x: ego.x, y: ego.y,
    speed: { min: 200, max: 600 },
    angle: { min: 0, max: 360 },
    scale: { start: 1.5, end: 0 },
    lifespan: 600,
    quantity: 30,
    blendMode: 'ADD',
    tint: ego.tintTopLeft || 0x00ff00
  });
  emitter.explode();

  ego.destroy();

  if(Math.random() < 0.03 + level*0.001){
    multi *= 1.5;
    lives += 3;
    msg('POWER SURGE — MULTI x' + multi.toFixed(1));
  }
}

function updateUI(){
  document.getElementById('score').textContent = Math.floor(score).toLocaleString();
  document.getElementById('multi').textContent = 'x' + multi.toFixed(1);
  document.getElementById('level').textContent = level;
  if(score > highScore){
    highScore = score;
    localStorage.setItem('ego_high', Math.floor(highScore));
  }
}

function msg(text){
  const m = document.getElementById('msg');
  m.textContent = text;
  m.style.animation = 'none';
  setTimeout(() => m.style.animation = '', 100);
  setTimeout(() => m.textContent = '', 3000);
}

function gameOver(){
  document.getElementById('finalScore').textContent = Math.floor(score).toLocaleString();
  document.getElementById('highScore').textContent = Math.floor(highScore).toLocaleString();
  document.getElementById('gameover').classList.remove('hidden');
}

function startGame(){
  document.getElementById('menu').classList.add('hidden');
  document.getElementById('loading').style.display = 'none';
  score = 0; multi = 1; level = 1; lives = IS_PREMIUM ? 999999 : 10;
  game.scene.scenes[0].scene.restart();
}

function openShop(){ document.getElementById('shop').classList.remove('hidden'); }
function closeShop(){ document.getElementById('shop').classList.add('hidden'); }

// Fake loading
let p = 0;
const loading = setInterval(() => {
  p += Math.random() * 18 + 10;
  document.getElementById('progress').textContent = ~~p + '%';
  if(p > 100){
    clearInterval(loading);
    setTimeout(() => document.getElementById('loading').style.display = 'none', 800);
  }
}, 100);
</script>
</body>
</html>