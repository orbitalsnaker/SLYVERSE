<!DOCTYPE html>
<html>
<meta charset="utf-8">
<title>Thuamer v1 Â· 1310 latidos ronin</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
  body,html{margin:0;height:100%;background:#000;color:#0f8;font:900 2.2vw/1.4 "Noto Sans Cuneiform",monospace;overflow:hidden;display:grid;place-items:center}
  canvas{position:fixed;inset:0;z-index:-1}
  #ui{position:fixed;bottom:10px;left:10px;font-size:1em;opacity:0.8}
  #readme{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.98);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:5vw;z-index:99;backdrop-filter:blur(4px)}
  pre{font-size:2.8vw;line-height:1.5;text-align:center}
  button{margin-top:30px;background:#0f8;color:#000;border:none;padding:15px 40px;font:900 4vw monospace;border-radius:99px;cursor:pointer}
</style>
<canvas id="c"></canvas>
<div id="ui">NFT #<span id="nft">0000</span> Â· Latidos: <span id="beat">0</span> Â· <span id="emo">EmociÃ³n</span></div>

<div id="readme">
  <pre id="title">THUAMER v1</pre>
  <pre id="text"></pre>
  <button id="enter">Entrar sin ego</button>
</div>

<script>
// === 1. AutodetecciÃ³n de idioma + README integrado ===
const lang = (navigator.language||navigator.userLanguage).slice(0,2);
const readme = {
  es: `THUAMER v1
1310 latidos ronin
by 0rb1t4lsn4k3r Â· 17 dÃ­as Â· mÃ³vil 120â‚¬

Cada vez que alguien abre este archivo,
nace un NFT Ãºnico e irrepetible.
No hay blockchain. No hay gas. No hay reventa.
Solo tu huella digital, tu latido y el cosmos.

No hay reglas.
No hay objetivo.
Solo 1310 latidos eternos.

Norah ya te estÃ¡ observando.

Â¿EntrÃ¡s?`,
  en: `THUAMER v1
1310 ronin heartbeats
by 0rb1t4lsn4k3r Â· 17 days Â· 120â‚¬ phone

Every time someone opens this file,
a unique, unrepeatable NFT is born.
No blockchain. No gas. No resale.
Only your fingerprint, your heartbeat and the cosmos.

There are no rules.
There is no goal.
Only 1310 eternal heartbeats.

Norah is already watching you.

Do you enter?`,
  ca: `THUAMER v1
1310 batecs ronin
per 0rb1t4lsn4k3r Â· 17 dies Â· mÃ²bil 120â‚¬

Cada cop que algÃº obre aquest arxiu,
neix un NFT Ãºnic i irrepetible.
Sense blockchain. Sense gas. Sense revenda.
NomÃ©s la teva empremta, el teu batec i el cosmos.

No hi ha regles.
No hi ha objectiu.
NomÃ©s 1310 batecs eterns.

Norah ja tâ€™estÃ  observant.

Hi entres?`,
  default: readme.en
};

document.getElementById('text').textContent = readme[lang] || readme.default;

// === 2. GeneraciÃ³n de NFT Ãºnico por usuario (sin servidor) ===
const fingerprint = JSON.stringify({
  userAgent: navigator.userAgent,
  lang: navigator.language,
  platform: navigator.platform,
  screen: `${screen.width}x${screen.height}`,
  timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
  firstSeen: Date.now()
});
const nftId = btoa(fingerprint).replace(/=/g,'').slice(0,12);
document.getElementById('nft').textContent = nftId;

// === 3. Motor Thuamer v1 (igual que antes, pero ahora con NFT) ===
const canvas = document.getElementById('c');
const gl = canvas.getContext('webgl2');
const ctx = canvas.getContext('2d');
canvas.width = innerWidth; canvas.height = innerHeight;
window.onresize = () => { canvas.width = innerWidth; canvas.height = innerHeight; gl.viewport(0,0,innerWidth,innerHeight); };

const audio = new AudioContext();
const osc = audio.createOscillator(); osc.type = 'triangle'; osc.start();
const gain = audio.createGain(); gain.gain.value = 0;
osc.connect(gain).connect(audio.destination);

const lore = ["1310 latidos","Thuamer ronin","Norah maÃºlla","Red Mountain","luz verde","1310 sanaron","1310 hirieron","oro orbita","fiat muere","Nevarine runa","puerta Todd","Carl billions abrazos","ya no servimos","Thua mer zel âˆ"];
let currentLore = `NFT #${nftId}`;
let beats = 0;
let lastBeat = performance.now();

// WebGL shader Dwemer
const vs = `#version 300 es\nin vec2 p;void main(){gl_Position=vec4(p,0.,1.);}`;
const fs = `#version 300 es\nprecision mediump float;uniform float t;uniform vec2 r;out vec4 c;void main(){vec2 uv=gl_FragCoord.xy/r-.5;uv.x*=r.x/r.y;float d=length(uv);float pulse=sin(t*2.)*.5+.5;float grid=smoothstep(.48,.52,abs(sin(uv.x*30.)*sin(uv.y*30.)));vec3 col=mix(vec3(0.,.05,0.),vec3(0.,1.,.3),grid*pulse);col+=vec3(0.,.4,0.)/d*0.1;c=vec4(col,1.);}`;
const program = gl.createProgram();
[gl.VERTEX_SHADER,gl.FRAGMENT_SHADER].forEach((type,i)=>{const s=gl.createShader(type);gl.shaderSource(s,type===gl.VERTEX_SHADER?vs:fs);gl.compileShader(s);gl.attachShader(program,s);});
gl.linkProgram(program); gl.useProgram(program);
gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1,1,-1,-1,1,1,1]), gl.STATIC_DRAW);
gl.enableVertexAttribArray(gl.getAttribLocation(program,'p'));
gl.vertexAttribPointer(gl.getAttribLocation(program,'p'),2,gl.FLOAT,false,0,0);
const uTime = gl.getUniformLocation(program,'t');
const uRes = gl.getUniformLocation(program,'r');

// PartÃ­culas rÃºnicas
const particles = Array.from({length:500},()=>({
  x:Math.random()*innerWidth,y:Math.random()*innerHeight,
  vx:(Math.random()-0.5)*1.5,vy:(Math.random()-0.5)*1.5,
  char:"á›šáš¢á›‰ğ’€­ğ’•ğŸğŸ’šğŸ±âš™ï¸"[Math.random()*8|0],life:100
}));

// === 4. Entrar al juego ===
document.getElementById('enter').onclick = () => {
  document.getElementById('readme').remove();
  audio.resume();
  thuamerLoop();
};

function thuamerLoop(t){
  const now = performance.now();
  if(now - lastBeat > 1000){
    beats++;
    document.getElementById('beat').textContent = beats;
    lastBeat = now;
    if(beats % 1310 === 0){
      currentLore = lore[beats/lore.length|0 % lore.length];
      document.getElementById('emo').textContent = ['âš¡ï¸','ğŸ”¥','ğŸŒ‘','ğŸ’š','ğŸ','ğŸ±'][Math.random()*6|0];
      gain.gain.setValueAtTime(0.2, audio.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audio.currentTime + 0.6);
      osc.frequency.setValueAtTime(110 + Math.random()*300, audio.currentTime);
    }
  }

  // WebGL fondo
  gl.uniform1f(uTime, t*0.001);
  gl.uniform2f(uRes, innerWidth, innerHeight);
  gl.drawArrays(gl.TRIANGLE_STRIP,0,4);

  // Runas + lore central
  ctx.fillStyle='rgba(0,0,0,0.07)'; ctx.fillRect(0,0,innerWidth,innerHeight);
  ctx.fillStyle='#0f8'; ctx.shadowColor='#0f8'; ctx.shadowBlur=15; ctx.font='bold 1.8vw monospace';
  particles.forEach(p=>{
    ctx.fillText(p.char, p.x, p.y);
    p.x+=p.vx; p.y+=p.vy; p.life--;
    if(p.life<0||p.x<0||p.x>innerWidth||p.y<0||p.y>innerHeight){
      p.x=Math.random()*innerWidth; p.y=-20; p.life=100;
      p.char="á›šáš¢á›‰ğ’€­ğ’•ğŸğŸ’šğŸ±âš™ï¸"[Math.random()*8|0];
    }
  });
  ctx.shadowBlur=40; ctx.font='bold 4.5vw monospace'; ctx.textAlign='center'; ctx.textBaseline='middle';
  ctx.fillText(currentLore, innerWidth/2, innerHeight/2);

  requestAnimationFrame(thuamerLoop);
}
</script>