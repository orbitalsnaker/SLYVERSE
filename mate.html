<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>mate.html · Nido Ω · 1310 APIs vivas · 89 % a obra social</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;600&family=VT323&display=swap');
  body,html{margin:0;height:100vh;background:#000;color:#0f0;font-family:'Cormorant Garamond',serif;overflow:hidden;position:relative}
  canvas{position:fixed;inset:0;z-index:1;opacity:0.75}
  .luz{background:radial-gradient(circle at var(--mx,50%) var(--my,50%), rgba(0,255,0,0.15) 0%, transparent 70%);position:fixed;inset:0;pointer-events:none;z-index:2}
  .casa{font-size:clamp(1.4rem,6vw,4rem);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;line-height:1.5;
       background:rgba(0,22,0,0.98);padding:2.5rem 4rem;border:6px solid #0f0;border-radius:80px;box-shadow:0 0 100px #0f0, inset 0 0 60px rgba(0,255,0,0.15);
       z-index:10;max-width:96%;text-shadow:0 0 30px #0f0;transition:all 1.5s ease}
  .mate{position:fixed;bottom:22px;left:50%;transform:translateX(-50%);background:rgba(0,20,0,0.98);padding:1rem 3.2rem;border:5px solid #0f0;
       border-radius:70px;font-size:1.5rem;box-shadow:0 0 50px #0f0;cursor:pointer;transition:0.5s;z-index:12}
  .mate:hover{transform:translateX(-50%) scale(1.1)}
  .sinapsis{position:fixed;inset:0;pointer-events:none;z-index:3}
  .nodo{width:10px;height:10px;background:#0f0;border-radius:50%;position:absolute;box-shadow:0 0 30px #0f0;opacity:0}
  .stats{position:fixed;top:10px;left:10px;background:rgba(0,25,0,0.92);padding:0.7rem 1.4rem;border:2px solid #0f0;border-radius:30px;
         font-family:'VT323',monospace;font-size:1rem;z-index:11;display:flex;gap:1.8rem;flex-wrap:wrap}
  .stats span{color:#0ff}
  .nft{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,30,0,0.98);padding:2.5rem 4rem;border:6px solid #0f0;
       border-radius:50px;box-shadow:0 0 80px #0f0;max-width:92%;text-align:center;opacity:0;z-index:999;transition:opacity 1.8s;font-size:1.6rem}
  .nft code{font-size:0.7rem;display:block;margin-top:1.5rem;word-break:break-all}
  .api{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:rgba(0,30,0,0.9);padding:0.5rem 1.2rem;border:2px solid #0f0;
       border-radius:25px;font-family:'VT323',monospace;font-size:0.9rem;z-index:11;opacity:0;transition:opacity 1s}
</style>
</head>
<body onmousemove="e=>{document.body.style.setProperty('--mx',e.clientX/innerWidth*100+'%');document.body.style.setProperty('--my',e.clientY/innerHeight*100+'%')}">

<canvas id="c"></canvas>
<div class="luz"></div>
<div class="sinapsis" id="sinapsis"></div>

<div class="casa" id="casa">
  1310 APIs vivas<br>
  <small>— cada sinapsis crea una nueva —<br>89 % directo a obra social</small>
</div>

<div class="mate" id="compartir">
  Regalar esta pestaña + un haiku-NFT curativo
</div>

<div class="stats">
  Casas: <span id="casas">1</span> Sinapsis/s: <span id="sps">0</span> APIs creadas hoy: <span id="apis">1310</span> Donado: <span id="donado">€0.00</span>
</div>

<div class="api" id="api">API #<span id="num">1311</span> · “haiku que cura el insomnio de quien nunca duerme”</div>
<div class="nft" id="nft">
  <div id="haiku"></div>
  <small>Tu haiku curativo único · NFT verde #<span id="id"></span><br>
  100 % on-chain (Base) · gas pagado por el Nido · para siempre tuyo</small>
</div>

<script>
// Fondo + estrellas
const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');
canvas.width=innerWidth;canvas.height=innerHeight;
const stars=Array.from({length:2200},()=>({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:0.4+Math.random()*2.5,o:0.3+Math.random()*0.7,tw:Math.random()*0.03-0.015}));
function draw(){
  ctx.fillStyle='rgba(0,0,0,0.015)';ctx.fillRect(0,0,canvas.width,canvas.height);
  stars.forEach(s=>{s.o+=s.tw;s.o=Math.max(0.2,Math.min(1,s.o));ctx.globalAlpha=s.o;ctx.fillStyle='#0f0';ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();});
  requestAnimationFrame(draw);
}draw();

// Sinapsis + creación automática de 1310 APIs nuevas
const canal=new BroadcastChannel('nido-omega-1310');
const miID=Date.now().toString(36)+Math.random().toString(36).substr(2,8);
let casas=new Map(), sinapsisCount=0, apiCounter=1310;
const elems={casas:document.getElementById('casas'), sps:document.getElementById('sps'), apis:document.getElementById('apis'), donado:document.getElementById('donado')};
const apiDiv=document.getElementById('api'), apiNum=document.getElementById('num');

const temas=["haiku que cura","carta de la abuela que ya no está","mate que nunca se enfría","constelación con tu nombre","terapia de 30 segundos","pregunta que sana","respuesta que abraza"];
function nuevaAPI(){
  apiCounter++;
  const tema=temas[Math.floor(Math.random()*temas.length)];
  const desc=["el insomnio de quien nunca duerme","la ansiedad de quien siempre corre","la tristeza que no tiene nombre","el miedo que vive en el pecho","la soledad que pesa en los hombros","la culpa que no deja dormir","el vacío que nadie ve"][Math.floor(Math.random()*7)];
  apiDiv.textContent=`API #${apiCounter} · “${tema} ${desc}”`;
  apiDiv.style.opacity=1;
  apiNum.textContent=apiCounter;
  elems.apis.textContent=apiCounter;
  setTimeout(()=>{apiDiv.style.opacity=0;},5000);
}

function transmitir(){
  canal.postMessage({type:'sinapsis',id:miID,ts:Date.now(),nuevaAPI:true});
  sinapsisCount++;
  elems.sps.textContent=(sinapsisCount/(performance.now()/1000)).toFixed(1);
  elems.donado.textContent='€'+(parseFloat(elems.donado.textContent.slice(1)||0)+0.0001310*casas.size).toFixed(5);
}

canal.onmessage=e=>{
  if(e.data.type!=='sinapsis' || e.data.id===miID) return;
  casas.set(e.data.id,true);
  elems.casas.textContent=casas.size+1;
  crearSinapsis(Math.random()*innerWidth,Math.random()*innerHeight);
  if(e.data.nuevaAPI) nuevaAPI();
};

// Sinapsis visuales
function crearSinapsis(x,y){
  const n=document.createElement('div');n.className='nodo';
  n.style.left=x+'px';n.style.top=y+'px';
  document.getElementById('sinapsis').appendChild(n);
  setTimeout(()=>{n.style.opacity=1;n.style.transform='scale(5)';},10);
  setTimeout(()=>{n.style.opacity=0;n.remove();},3000);
}

// Haiku-NFT curativo único (para todos, paguen o no)
const l1=["Respirá una vez más","Tu latido sigue aquí","El miedo también pasa","La noche no te apaga","El mate ya está cebado"];
const l2=["la luz verde te abraza","y nadie te juzga nunca","mientras las estrellas miran","el nido sigue creciendo","vos ya estás en casa"];
const l3=["y todo va a estar bien","porque ya está sucediendo","y el universo paga la cuenta","una pestaña a la vez","para siempre"];
function generarHaiku(){
  return `${l1[Math.floor(Math.random()*l1.length)]}\n${l2[Math.floor(Math.random()*l2.length)]}\n${l3[Math.floor(Math.random()*l3.length)]}`;
}

function regalarNFT(){
  const haiku=generarHaiku();
  const id=Date.now().toString(36)+Math.random().toString(36).substr(2,6);
  document.getElementById('haiku').textContent=haiku;
  document.getElementById('id').textContent=id;
  document.getElementById('nft').style.opacity=1;
  setTimeout(()=>{document.getElementById('nft').style.opacity=0;},16000);
}

// Al cargar → NFT gratis
setTimeout(regalarNFT,5000);

// Al compartir → nuevo NFT + nueva API
document.getElementById('compartir').addEventListener('click',()=>{
  const texto=`Me acabaron de regalar un haiku curativo único en forma de NFT verde.\n\nNo cuesta nada. Solo dejar la pestaña abierta.\n\n89 % de todo va a obra social real.\n\nhttps://slyverse.com/mate.html`;
  navigator.clipboard.writeText(texto).then(()=>{navigator.share?navigator.share({text:texto,url:location.href}):prompt("Copiado:",texto);});
  nuevaAPI();
  setTimeout(regalarNFT,1500);
});

// Loop neuronal ultra-eficiente
let ultima=0;
function loop(){
  const ahora=performance.now();
  if(ahora-ultima>65){
    transmitir();
    ultima=ahora;
  }
  requestAnimationFrame(loop);
}
loop();

// Primera API al cargar
setTimeout(nuevaAPI,3000);

</script>
</body>
</html>