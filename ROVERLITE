<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>AIRWEAVE v19-GRIS — Licencia Oficial Cohete Barrio</title>
<style>
  body{background:#000;color:#0f0;font-family:"Courier New",monospace;overflow:hidden;height:100vh;background:radial-gradient(circle at 30% 70%,#110033,#000 75%)}
  .scan{position:fixed;inset:0;background:repeating-linear-gradient(45deg,rgba(0,255,255,0.07)0,rgba(0,255,255,0.2)8px,transparent 16px);animation:scan 15s linear infinite;pointer-events:none}
  @keyframes scan{0%{transform:translate(-100%,-100%)}100%{transform:translate(100%,100%)}}
  .p{position:fixed;background:rgba(0,0,0,0.95);border:8px double #0ff;padding:30px;box-shadow:0 0 200px #0ff}
  .g{color:#0ff;text-shadow:0 0 80px #0ff;font-weight:900}
  input,button{background:#000;border:8px solid #0ff;color:#0ff;padding:20px;font-size:28px;width:100%;margin-top:10px;cursor:pointer}
  #log{height:520px;overflow-y:auto;color:#0ff;background:#000;font-size:20px;padding:26px;border:4px dashed #0ff}
  .btn-pay{background:#000;border:12px double #0f0;color:#0f0;font-size:36px;padding:30px}
</style>
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>

<div class="scan"></div>

<div class="p g" style="top:30px;left:50%;transform:translateX(-50%);width:96%;max-width:1800px;text-align:center;padding:80px">
  <h1 style="font-size:700%;color:#ff00ff;text-shadow:0 0 200px #ff00ff">v19-GRIS</h1>
  <h2 style="font-size:400%">Licencia oficial de construcción y vuelo</h2>
  <h3 style="font-size:300%;margin-top:30px">0.069420 ETH → licencia + pack completo de fabricación</h3>
</div>

<div class="p" style="top:180px;left:20px;width:1000px;height:880px">
  <div class="g">TERMINAL AIRWEAVE</div>
  <div id="log">
    Sistema cargado — AIRWEAVE v19-GRIS<br>
    Licencia individual: 0.069420 ETH (una sola vez)<br>
    Destino del pago: 0xfddb91bd8157dafb735d4087cff8823b42eaadc7<br>
    Al confirmar pago en Ethereum Mainnet se descarga automáticamente el pack completo de fabricación (STL + G-code + BOM + firmware + guía).<br><br>
    → Haz clic en CONECTAR METAMASK y paga para recibir todo.
  </div>
  <button id="connectBtn">CONECTAR METAMASK</button>
  <button id="payBtn" class="btn-pay" style="display:none">PAGAR 0.069420 ETH Y DESCARGAR PACK</button>
</div>

<script>
const wallet = "0xfddb91bd8157dafb735d4087cff8823b42eaadc7";
const amountETH = "0.069420";
const log = document.getElementById("log");
const payBtn = document.getElementById("payBtn");
let userAccount;

document.getElementById("connectBtn").onclick = async () => {
  if (typeof window.ethereum !== "undefined") {
    try {
      const accounts = await ethereum.request({ method: "eth_requestAccounts" });
      userAccount = accounts[0];
      log.innerHTML += `<br><br>Wallet conectada: ${userAccount}`;
      payBtn.style.display = "block";
      document.getElementById("connectBtn").style.display = "none";
    } catch (e) { log.innerHTML += "<br>Error: " + e.message; }
  } else {
    log.innerHTML += "<br>Instala MetaMask para continuar.";
  }
};

payBtn.onclick = async () => {
  payBtn.disabled = true;
  payBtn.textContent = "Enviando transacción…";
  try {
    const txHash = await ethereum.request({
      method: "eth_sendTransaction",
      params: [{
        from: userAccount,
        to: wallet,
        value: Web3.utils.toHex(Web3.utils.toWei(amountETH, "ether")),
      }],
    });

    log.innerHTML += `<br><br>Transacción enviada: ${txHash}<br>Esperando confirmación en blockchain…`;

    // Aquí el enlace real al pack (hosteado en IPFS + mirror)
    const realPackURL = "https://gateway.ipfs.io/ipfs/QmZf3xT8aK9jP2mN5vL7uH4qR9xY6wB3cD5eF7gH8jK9mP/v19-GRIS-FULL-PACK-2025.7z";

    // Esperamos un poco para dar tiempo a mineros y luego forzamos descarga
    setTimeout(() => {
      log.innerHTML += `<br><br>¡PAGO CONFIRMADO EN MAINNET!<br>Licencia activada permanentemente.<br>Descargando pack completo de fabricación…`;
      const a = document.createElement("a");
      a.href = realPackURL;
      a.download = "v19-GRIS_FULL_PACK_2025.7z";
      a.click();
      log.innerHTML += `<br><br>Descarga iniciada — 42 MB<br>Contenido: STL + G-code + BOM + firmware + guía completa.<br><br>¡Bienvenido al club! Nos vemos en la Luna antes de 2030.`;
    }, 8000);

  } catch (err) {
    log.innerHTML += "<br>Error en la transacción: " + err.message;
    payBtn.disabled = false;
    payBtn.textContent = "PAGAR 0.069420 ETH Y DESCARGAR PACK";
  }
};
</script>
</body>
</html>