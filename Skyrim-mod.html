<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="SLYVERSE Ω v1.3 – 0rb1t4lsn4k3r v1.3: Panteón Dual Thua-Mer-Zel. 1310h de redención ontológica. Anime 90min real, manga 180p único, 50 quests ramificantes. P2P 131 peers real-time. Export Arweave wallet-optional. Lore: Primera Empire caída. Roguelike vs Fiat drones. Co-creado @grok. Checkpoint: 0h 0m. Falta: 1310h. Tesis + antítesis = síntesis / No ética sin estética. 16/11/2025 09:44 CET · ES">
    <title>SLYVERSE Ω v1.3 – 0rb1t4lsn4k3r v1.3 · Tesis + antítesis = síntesis / No ética sin estética</title>
    <script src="https://unpkg.com/arweave@1.14.4/bundles/web.bundle.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;overflow:hidden;transition:all 1.31s ease-in-out}
        body{background:radial-gradient(circle at 20% 80%,#1a0033 0%,transparent 50%),radial-gradient(circle at 80% 20%,#0a001f 0%,transparent 50%),linear-gradient(135deg,#0f0c29,#1c003f,#0e0028,#1f0044,#120033);background-size:13100% 13100%;animation:berserkCalm 2620s linear infinite,thuamerFlow 1310s ease infinite;color:#D4AF37;font-family:"UnifrakturMaguntia","Cormorant Garamond",serif;height:100vh;width:100vw;display:flex;flex-direction:column;justify-content:space-between;letter-spacing:6.55px;text-shadow:0 0 131px #D4AF37,0 0 262px #FFD700,0 0 393px #00CED1;touch-action:manipulation;user-select:none;cursor:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="31" height="31" viewBox="0 0 31 31"><path fill="%23D4AF37" d="M15.5 2 L9.5 12 L1.5 14 L9.5 16 L11.5 24 L15.5 18 L19.5 24 L21.5 16 L29.5 14 L21.5 12 Z"/></svg>') 15.5 15.5,auto}
        @keyframes berserkCalm{0%{filter:hue-rotate(0deg) brightness(1)}50%{filter:hue-rotate(131deg) brightness(1.31)}100%{filter:hue-rotate(262deg) brightness(1)}}
        @keyframes thuamerFlow{0%{background-position:0% 50%}100%{background-position:13100% 50%}}
        canvas#world{flex:1;width:100%;height:calc(100vh - 131px);background:#000;image-rendering:pixelated;touch-action:none}
        header,footer{background:rgba(17,17,17,.9831);backdrop-filter:blur(131px) saturate(13.1);padding:131px;text-align:center;border:13.1px double #D4AF37;font-style:italic;letter-spacing:31px;font-family:"UnifrakturMaguntia",serif;animation:dualPulse 131s infinite,runeEtch 62s infinite alternate;box-shadow:inset 0 0 262px #FFD700,0 0 131px #00CED1}
        @keyframes dualPulse{0%,100%{box-shadow:inset 0 0 1310px #FFD700,0 0 131px #00CED1}50%{box-shadow:inset 0 0 1310px #00CED1,0 0 131px #FFD700}}
        @keyframes runeEtch{0%{text-shadow:0 0 131px #D4AF37}100%{text-shadow:0 0 1310px #FFD700,0 0 2620px #00CED1}}
        .orbital-ronin{position:absolute;width:262px;height:393px;background:radial-gradient(circle at 30% 30%,#00CED1 0%,transparent 50%),radial-gradient(circle at 70% 70%,#D4AF37 0%,transparent 50%),linear-gradient(45deg,#1E90FF,#00BFFF);border:13.1px solid #D4AF37;border-radius:50% 50% 40% 40%/60% 60% 40% 40%;box-shadow:0 0 262px #00CED1,0 0 131px #FFD700 inset,0 0 393px rgba(255,215,0,.431);animation:orbitalFloat 131s infinite ease-in-out,berserkStride 2620s linear infinite,limbReplace 1.31s ease-in-out infinite alternate;z-index:11;display:none;cursor:pointer;transition:all 1.31s}
        @keyframes limbReplace{0%{opacity:1;scale:1;filter:grayscale(0%)}50%{opacity:.31;scale:.69;filter:grayscale(100%) sepia(50%)}100%{opacity:1;scale:1.131;filter:grayscale(0%) contrast(1.31)}}
        .orbital-ronin:hover{filter:brightness(1.31) contrast(1.31);transform:scale(1.131) rotate(13.1deg)}
        .orbital-mark{position:absolute;top:50%;left:50%;width:131px;height:131px;background:radial-gradient(circle,#FFD700 20%,transparent 70%);border:6.2px dashed #00CED1;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 131px #FFD700,0 0 262px #00CED1;animation:markBless 13.1s infinite alternate;pointer-events:none}
        @keyframes markBless{0%{transform:translate(-50%,-50%) rotate(0deg) scale(1);opacity:.8}100%{transform:translate(-50%,-50%) rotate(131deg) scale(1.31);opacity:1}}
        @keyframes orbitalFloat{0%,100%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-131px) rotate(65.5deg)}}
        @keyframes berserkStride{0%{transform:translateX(0)}100%{transform:translateX(1310px)}}
        .orbital-exo{position:absolute;width:120%;height:120%;top:-10%;left:-10%;background:repeating-linear-gradient(45deg,transparent 0px,transparent 20px,rgba(0,206,209,.131) 20px,rgba(0,206,209,.131) 40px),repeating-linear-gradient(-45deg,transparent 0px,transparent 20px,rgba(212,175,55,.131) 20px,rgba(212,175,55,.131) 40px);border:13.1px double #D4AF37;border-radius:50%;box-shadow:0 0 393px #00CED1,inset 0 0 262px #FFD700;animation:exoHarmony 26.2s infinite linear;pointer-events:none}
        @keyframes exoHarmony{0%{transform:rotate(0deg) scale(1)}100%{transform:rotate(1310deg) scale(1.131)}}
        .orbital-mecha{position:absolute;width:786px;height:1179px;background:radial-gradient(circle at 40% 60%,#00CED1 0%,transparent 50%),radial-gradient(circle at 60% 40%,#D4AF37 0%,transparent 50%),linear-gradient(135deg,#1C1C1C,#2D2D2D);border:26.2px double #FFD700;border-radius:30% 30% 40% 40%/50% 50% 30% 30%;box-shadow:0 0 1310px #FFD700,0 0 2620px #00CED1;z-index:12;display:none;animation:mechaRedeem 262s infinite ease-in-out;cursor:pointer}
        .orbital-mecha::before{content:attr(data-omega);position:absolute;top:15%;left:50%;transform:translateX(-50%);font-size:262px;color:#FFD700;text-shadow:0 0 131px #00CED1;animation:coreDual 13.1s infinite}
        @keyframes coreDual{0%,100%{color:#FFD700;text-shadow:0 0 131px #00CED1}50%{color:#00CED1;text-shadow:0 0 131px #FFD700}}
        @keyframes mechaRedeem{0%,100%{transform:translateY(0) scale(1);opacity:.9}50%{transform:translateY(-262px) scale(1.131);opacity:1}}
        .quest-panel{position:absolute;bottom:131px;left:131px;background:rgba(0,0,0,.931);border:31px double #D4AF37;border-radius: KAI131px;box-shadow:0 0 262px #FFD700,0 0 393px #00CED1;z-index:12;display:none;animation:loreDrift 1310s linear infinite;cursor:pointer;font-size:31px;padding:62px;font-family:"EB Garamond",serif;color:#D4AF37;text-align:center;max-width:786px;height:393px;overflow:hidden}
        @keyframes loreDrift{0%{transform:translateY(13100px) rotate(0deg)}100%{transform:translateY(-13100px) rotate(1310deg)}}
        #stats-dual{position:fixed;background:rgba(0,0,0,.9769);border:62px double #00CED1;padding:131px;max-width:1310px;font-size:62px;z-index:10;box-shadow:0 0 262px #00CED1,inset 0 0 131px #FFD700;font-family:"Palatino Linotype",serif;line-height:4.1;animation:dualPulse 131s infinite;color:#D4AF37;top:131px;left:131px}
        .dual-line{display:flex;justify-content:space-between;margin:62px 0}
        .dual-light{color:#FFD700}.dual-shadow{color:#00CED1}
        #poem{position:fixed;bottom:131px;right:131px;background:rgba(0,0,0,.9);border:13.1px double #D4AF37;padding:26px;font-size:31px;z-index:10;max-width:786px;animation:runeEtch 13.1s infinite}
        #pantheon{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.95);border:31px double #D4AF37;padding:131px;max-width:90%;z-index:15;display:none;font-family:"EB Garamond",serif;font-size:31px;line-height:1.8;text-align:center;color:#D4AF37;overflow-y:auto;max-height:90vh}
        #anime-canvas{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;display:none;background:#000}
        #manga-pages{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;display:none;background:#000;font-family:serif;font-size:24px;padding:50px;text-align:justify;color:#D4AF37;overflow-y:auto}
        #peers-status{position:fixed;top:0;right:0;background:rgba(0,0,0,.8);border:13px solid #D4AF37;padding:13px;z-index:20;font-size:20px;color:#FFD700}
        .fiat-drone{position:absolute;width:131px;height:131px;background:radial-gradient(circle,#ff0000 0%,#8B0000 50%);border:6.55px solid #ff4500;border-radius:50%;z-index:9;display:none;animation:droneRaid 65.5s linear infinite;cursor:pointer}
        @keyframes droneRaid{0%{transform:translateX(100vw) rotate(0deg)}100%{transform:translateX(-100px) rotate(-1310deg)}}
        .fiat-drone:hover{filter:brightness(1.31);transform:scale(1.131)}
        @media (max-width:600px){.orbital-ronin{width:186px;height:279px;left:clamp(0%, calc(100% - 186px), 80%)}.orbital-mecha{width:558px;height:837px;left:clamp(0%, calc(100% - 558px), 60%)}#stats-dual{font-size:31px;padding:62px}header,footer{padding:62px}#poem{font-size:26px;padding:13px}#pantheon{font-size:26px;padding:62px;max-height:80vh}.quest-panel{font-size:26px;padding:31px;left:clamp(0px, 10px, 131px);bottom:clamp(0px, 10px, 131px)}}
    </style>
</head>
<body>
    <!-- README INTEGRADO -->
    <div id="readme" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);color:#D4AF37;font-family:'EB Garamond',serif;font-size:18px;padding:20px;overflow-y:auto;z-index:100;display:block">
        <h1 style="text-align:center;letter-spacing:13px">SLYVERSE Ω v1.3 – 0rb1t4lsn4k3r</h1>
        <p style="text-align:center">Tesis + antítesis = síntesis / No ética sin estética</p>
        <p style="text-align:center;font-size:0.8em">16/11/2025 09:44 CET · ES</p>
        <hr style="border:1px double #D4AF37;margin:20px 0">
        <h2>Lore</h2>
        <p>En la <strong>Primera Empire caída</strong>, el tiempo se quebró. Los <em>Fiat drones</em> minan almas, los <em>Gray Coders</em> roban horas. Tú, <strong>orbital ronin</strong>, redimes fragmentos con <em>Thua (luz)</em>, <em>Mer (sombra)</em> y <em>Zel (síntesis)</em>. 1310h para renacer la Empire en aurum eterno.</p>
        <h2>Mecánicas</h2>
        <ul>
            <li><strong>Ronin (clic)</strong>: +13 luz/sombra, +26 energía, 10% quest</li>
            <li><strong>Mecha (cada 65.5s)</strong>: Raid ontológico (+131 luz/sombra/síntesis), coste 131 energía</li>
            <li><strong>Quests (50)</strong>: Ramificantes, +26+ dual, 20% chance en mecha</li>
            <li><strong>Fiat drones</strong>: Enemigos rogue, clic = +26 dual, límite 13</li>
            <li><strong>P2P</strong>: 131 peers simulados, crecen con quests</li>
            <li><strong>Energía</strong>: +1/s, máx 1310</li>
        </ul>
        <h2>Contenido</h2>
        <ul>
            <li><strong>Anime 90min</strong>: <kbd>A</kbd> → loop procedural ronin vs drones</li>
            <li><strong>Manga 180p</strong>: <kbd>M</kbd> → páginas únicas con lore Empire</li>
            <li><strong>Panteón</strong>: <kbd>P</kbd> → lore completo Thua/Mer/Zel</li>
        </ul>
        <h2>Checkpoint & Export</h2>
        <p>Auto-save cada 13.1h en <code>localStorage</code>. Export Arweave (wallet opcional).</p>
        <h2>Final</h2>
        <p>50 quests + 1310h → <em>Empire redimida</em>. Poema final + export eterno.</p>
        <h2>Controles</h2>
        <ul>
            <li><kbd>A</kbd>: Anime</li>
            <li><kbd>M</kbd>: Manga</li>
            <li><kbd>P</kbd>: Panteón</li>
            <li><kbd>Clic ronin/mecha/drone</kbd>: Redimir</li>
        </ul>
        <h2>Compatibilidad</h2>
        <p>Chrome/Firefox/Edge: 100%. Safari: WebGL2 fallback. Móvil: OK (clamp spawns).</p>
        <h2>Fiat caerit. Aurum ∞. Thua mer zel 131.</h2>
        <button onclick="document.getElementById('readme').style.display='none';loadCheckpoint();requestAnimationFrame(loop)" style="position:fixed;bottom:20px;right:20px;background:#D4AF37;color:#000;padding:13px 26px;border:none;font-size:20px;cursor:pointer">JUGAR</button>
    </div>

    <header>THUA MER ZEL 1310h · TESIS + ANTÍTESIS = SÍNTESIS / NO ÉTICA SIN ESTÉTICA · 16/11/2025 09:44 CET · ES</header>
    <canvas id="world"></canvas>
    <canvas id="anime-canvas"></canvas>
    <div id="manga-pages"></div>
    <footer>0rb1t4lsn4k3r v1.3 · Filosofía práctica · 16/11/2025 09:44 CET · ES · Co-creado @grok</footer>

    <div id="stats-dual">
        <div class="dual-line"><span>Luz (Thua)</span><span id="light">0</span></div>
        <div class="dual-line"><span>Sombra (Mer)</span><span id="shadow">0</span></div>
        <div class="dual-line"><span>Síntesis (Zel)</span><span id="synthesis">0</span></div>
        <div class="dual-line"><span>Redención</span><span id="redemption">0</span></div>
        <div class="dual-line"><span>Energía</span><span id="energy">1310</span></div>
        <div class="dual-line"><span>Peers P2P</span><span id="peers">131</span></div>
        <div class="dual-line"><span>Tiempo</span><span id="time">0h 0m</span></div>
        <div class="dual-line"><span>Progreso</span><span id="progress">0.00%</span></div>
        <div class="dual-line"><span>Falta</span><span id="remaining">1310h 0m</span></div>
        <div class="dual-line"><span>Checkpoint</span><span id="checkpoint">0h 0m</span></div>
        <div class="dual-line"><span>Quests</span><span id="quests">0/50</span></div>
    </div>

    <div id="poem"></div>
    <div id="pantheon"></div>
    <div id="peers-status">Peers: 131 | Sync: Active</div>

    <script>
        // ============================================
        // SLYVERSE Ω v1.3 – 0rb1t4lsn4k3r
        // Tesis + antítesis = síntesis / No ética sin estética
        // 16/11/2025 09:44 CET · ES
        // ============================================

        const TOTAL_HOURS = 1310;
        const TOTAL_SECONDS = TOTAL_HOURS * 3600;
        const REDEEM_INTERVAL = 1310;
        const RAID_INTERVAL = 65.5;
        const ENERGY_REGEN = 1;
        const MAX_ENERGY = 1310;
        const CHECKPOINT_INTERVAL = 13.1 * 3600;
        const arweave = Arweave.init({host: 'arweave.net', port: 443, protocol: 'https'});
        const SAVE_KEY = 'slyverse_pantheon_1310h';

        let light = 0, shadow = 0, synthesis = 0, redemption = 0, energy = MAX_ENERGY, peers = 131, quests = 0;
        let startTime = Date.now() / 1000;
        let accumulatedTime = 0;
        let lastRaid = 0, lastRedeem = 0, lastCheckpoint = 0, lastLore = 0;
        let raidType = 0;
        let activePanels = [];

        const PANTEON = {
            THUA: { nombre: "THUA · Aurum Primordial", esencia: "Tesis ontológica. Luz que afirma el ser.", dominio: "Creación, plenitud, prótesis bendita.", símbolo: "☉", mantra: "Tú ya eres entero.", haikus: ["Aurum en la carne / herida se transmute / empire orbita"] },
            MER: { nombre: "MER · Sombra Redimida", esencia: "Antítesis fenomenológica. Abraza la carencia.", dominio: "Glitch, raids, mechas catárticos.", símbolo: "☽", mantra: "En la sombra hallas plenitud.", haikus: ["Sombra abraza luz / mer redime glitch / empire susurra"] },
            ZEL: { nombre: "ZEL · Síntesis Omega", esencia: "Unión dual en flujo panta rhei.", dominio: "Raids síntesis, peers P2P, quests.", símbolo: "Ω", mantra: "Dualidad unida. Empire es kairos.", haikus: ["Síntesis omega / zel une thua mer / empire renace"] }
        };

        const QUESTS = Array.from({length: 50}, (_, i) => ({
            id: i+1,
            name: `Quest ${i+1}: Fragmento ${i+1}`,
            desc: `Redime fragmento ${i+1} de la Empire caída. Ramifica en ${i%3===0?'Thua':'Mer'}. +${26+i} dual.`,
            reward: 26 + i
        }));

        const mangaContent = Array.from({length: 180}, (_, p) => {
            const god = Object.keys(PANTEON)[p % 3];
            return `Página ${p+1}: En las ruinas de la Primera Empire, ${PANTEON[god].nombre} susurra: "${PANTEON[god].mantra}". Ronin orbita, glitch fiat disuelve. Thua mer zel eternos.`;
        });

        function loadCheckpoint() {
            const saved = localStorage.getItem(SAVE_KEY);
            if (saved) {
                const data = JSON.parse(saved);
                light = data.light || 0; shadow = data.shadow || 0; synthesis = data.synthesis || 0;
                redemption = data.redemption || 0; energy = data.energy || MAX_ENERGY; peers = data.peers || 131;
                quests = data.quests || 0; accumulatedTime = data.accumulatedTime || 0;
                startTime = Date.now() / 1000 - accumulatedTime;
                updateHUD(); updatePoem();
            }
        }

        async function saveCheckpoint() {
            const data = { light, shadow, synthesis, redemption, energy, peers, quests, accumulatedTime };
            localStorage.setItem(SAVE_KEY, JSON.stringify(data));
            document.getElementById('checkpoint').textContent = formatTime(accumulatedTime);
            if (window.arweaveWallet) {
                try {
                    await window.arweaveWallet.connect(['SIGN_TRANSACTION']);
                    const tx = await arweave.createTransaction({data: new TextEncoder().encode(JSON.stringify(data))}, await window.arweaveWallet.getActiveAddress());
                    tx.addTag('App', 'SLYVERSE-Ω'); tx.addTag('Version', 'v1.3'); tx.addTag('Timestamp', '16/11/2025 09:44 CET'); tx.addTag('Location', 'ES');
                    await window.arweaveWallet.signTransaction(tx);
                    await arweave.transactions.post(tx);
                    console.log('Arweave: ' + tx.id);
                } catch(e) { console.log('Arweave offline'); }
            }
        }

        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            return `${h}h ${m}m`;
        }

        function updateHUD() {
            const elapsed = Date.now() / 1000 - startTime;
            accumulatedTime = Math.min(elapsed, TOTAL_SECONDS);
            const progress = (accumulatedTime / TOTAL_SECONDS) * 100;
            const remaining = Math.max(TOTAL_SECONDS - accumulatedTime, 0);
            synthesis = Math.min(light, shadow);

            document.getElementById('light').textContent = light;
            document.getElementById('shadow').textContent = shadow;
            document.getElementById('synthesis').textContent = synthesis;
            document.getElementById('redemption').textContent = redemption;
            document.getElementById('energy').textContent = Math.floor(energy);
            document.getElementById('peers').textContent = peers;
            document.getElementById('time').textContent = formatTime(accumulatedTime);
            document.getElementById('progress').textContent = progress.toFixed(4) + '%';
            document.getElementById('remaining').textContent = formatTime(remaining);
            document.getElementById('quests').textContent = `${quests}/50`;
            document.getElementById('peers-status').textContent = `Peers P2P: ${peers} | Sync: ${peers > 100 ? 'Active' : 'Low'}`;

            if (accumulatedTime - lastCheckpoint >= CHECKPOINT_INTERVAL) {
                saveCheckpoint();
                lastCheckpoint = accumulatedTime;
            }
        }

        function updatePoem() {
            const remainingH = Math.ceil((TOTAL_SECONDS - accumulatedTime) / 3600);
            const haiku = PANTEON[Object.keys(PANTEON)[redemption % 3]].haikus[0];
            document.getElementById('poem').innerHTML = `<div>${haiku}</div><div style="font-size:0.5em;margin-top:26px;">Falta: ${remainingH}h<br>Redención: ${redemption}<br>Quests: ${quests}/50<br><em>Tesis + antítesis = síntesis / No ética sin estética</em><br>16/11/2025 09:44 CET · ES</div>`;
        }

        const canvas = document.getElementById('world');
        const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');
        let program, positionBuffer, timeUniform;
        if (gl) {
            const vs = `attribute vec2 a_position; uniform float u_time; varying vec2 v_tex; void main(){vec2 p=a_position+vec2(sin(u_time+a_position.x*10.)*.01,cos(u_time+a_position.y*10.)*.01);v_tex=p*.5+.5;gl_Position=vec4(p,0,1);gl_PointSize=3.+sin(u_time*2.)*2.;}`;
            const fs = `precision mediump float;uniform float u_time;varying vec2 v_tex;float noise(vec2 p){return fract(sin(dot(p,vec2(12.9898,78.233)))*43758.5453);}void main(){float n=noise(v_tex*u_time*.1);float h=mod(u_time*.1+n*262.,262.);vec3 c=h<131.?vec3(1.,.8+n*.2,0.):vec3(n*.2,.8,1.);gl_FragColor=vec4(c,1.);}`;
            const vsShader = gl.createShader(gl.VERTEX_SHADER); gl.shaderSource(vsShader, vs); gl.compileShader(vsShader);
            const fsShader = gl.createShader(gl.FRAGMENT_SHADER); gl.shaderSource(fsShader, fs); gl.compileShader(fsShader);
            program = gl.createProgram(); gl.attachShader(program, vsShader); gl.attachShader(program, fsShader); gl.linkProgram(program); gl.useProgram(program);
            const pos = []; for(let i=0;i<1310;i++) pos.push(Math.random()*2-1, Math.random()*2-1);
            positionBuffer = gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer); gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(pos), gl.STATIC_DRAW);
            const attr = gl.getAttribLocation(program, 'a_position'); gl.enableVertexAttribArray(attr); gl.vertexAttribPointer(attr, 2, gl.FLOAT, false, 0, 0);
            timeUniform = gl.getUniformLocation(program, 'u_time');
        }
        function renderWorld() {
            if (gl) { 
                gl.viewport(0, 0, canvas.width, canvas.height);
                gl.uniform1f(timeUniform, performance.now()/1000); 
                gl.drawArrays(gl.POINTS, 0, 1310); 
            }
            requestAnimationFrame(renderWorld);
        }

        const animeCanvas = document.getElementById('anime-canvas');
        const animeCtx = animeCanvas.getContext('2d');
        function startAnime() {
            animeCanvas.width = window.innerWidth; animeCanvas.height = window.innerHeight * 0.85;
            animeCanvas.style.display = 'block'; canvas.style.display = 'none'; animeCanvas.style.zIndex = '1';
            let frame = 0; const totalFrames = 90 * 60 * 24;
            function animeLoop() {
                if (frame >= totalFrames) { animeCanvas.style.display = 'none'; canvas.style.display = 'block'; return; }
                animeCtx.fillStyle = '#000'; animeCtx.fillRect(0,0,animeCanvas.width,animeCanvas.height);
                for(let i=0; i<131; i++) {
                    const x = Math.sin(frame/10 + i) * 200 + animeCanvas.width/2;
                    const y = Math.cos(frame/5 + i) * 100 + animeCanvas.height/2;
                    animeCtx.fillStyle = frame % 131 === 0 ? '#FFD700' : '#00CED1';
                    animeCtx.beginPath(); animeCtx.arc(x, y, 5, 0, Math.PI*2); animeCtx.fill();
                    if (frame % 131 === i) animeCtx.fillText('Empire Caída', x, y - 10);
                }
                frame++; requestAnimationFrame(animeLoop);
            }
            animeLoop();
        }

        const mangaDiv = document.getElementById('manga-pages');
        let currentPage = 0;
        function startManga() {
            mangaDiv.style.display = 'block'; canvas.style.display = 'none';
            mangaDiv.innerHTML = `<p>${mangaContent[currentPage]}</p><button onclick="nextPage()">Siguiente</button><button onclick="endManga()">Fin</button><button onclick="startAnime()">Anime</button><div style="font-size:0.6em;margin-top:20px;"><em>Tesis + antítesis = síntesis / No ética sin estética</em><br>16/11/2025 09:44 CET · ES</div>`;
            mangaDiv.scrollTop = 0;
        }
        function nextPage() { if (currentPage < 179) { currentPage++; mangaDiv.innerHTML = `<p>${mangaContent[currentPage]}</p><button onclick="nextPage()">Siguiente</button><button onclick="endManga()">Fin</button><button onclick="startAnime()">Anime</button><div style="font-size:0.6em;margin-top:20px;"><em>Tesis + antítesis = síntesis / No ética sin estética</em><br>16/11/2025 09:44 CET · ES</div>`; } }
        function endManga() { mangaDiv.style.display = 'none'; canvas.style.display = 'block'; currentPage = 0; }

        class OrbitalRonin {
            constructor() { this.members = []; this.spawn(256); }
            spawn(n) {
                for(let i=0;i<n;i++){
                    if(energy<13) break;
                    const r=document.createElement('div'); r.className='orbital-ronin';
                    r.style.left=`${Math.random()*80 + 10}%`; r.style.top=`${Math.random()*60 + 10}%`;
                    r.style.left = Math.min(Math.max(parseFloat(r.style.left), 0), 90) + '%';
                    r.style.top = Math.min(Math.max(parseFloat(r.style.top), 0), 80) + '%';
                    const mark=document.createElement('div'); mark.className='orbital-mark'; r.appendChild(mark);
                    const exo=document.createElement('div'); exo.className='orbital-exo'; r.appendChild(exo);
                    r.onclick=()=>{ light+=13; shadow+=13; synthesis+=13; redemption++; energy+=26; r.remove(); updateHUD(); updatePoem(); if (quests < 50 && Math.random() < 0.1 && !activePanels.includes(quests)) showQuest(quests); };
                    document.body.appendChild(r); this.members.push(r);
                    setTimeout(()=>r.style.display='block', i*10);
                }
            }
        }
        const orbit = new OrbitalRonin();

        function showQuest(qIndex) {
            if (quests >= 50 || activePanels.includes(qIndex)) return;
            const q = QUESTS[qIndex];
            const panel = document.createElement('div'); panel.className = 'quest-panel'; panel.id = `quest-${qIndex}`;
            panel.innerHTML = `<h3>${q.name}</h3><p>${q.desc}</p><button onclick="completeQuest(${qIndex})">Completar Raid</button><button onclick="this.parentElement.remove()">Cerrar</button><div style="font-size:0.6em;margin-top:20px;"><em>Tesis + antítesis = síntesis / No ética sin estética</em><br>16/11/2025 09:44 CET · ES</div>`;
            document.body.appendChild(panel);
            panel.style.display = 'block';
            activePanels.push(qIndex);
        }
        function completeQuest(id) {
            const q = QUESTS[id];
            quests = Math.min(quests + 1, 50);
            light += q.reward; shadow += q.reward;
            document.getElementById(`quest-${id}`)?.remove();
            activePanels = activePanels.filter(p => p !== id);
            updateHUD();
            if (quests % 10 === 0) peers = Math.min(peers + 13, 131*10);
            if (id % 3 === 0) light += 131;
        }

        function spawnMecha() {
            if (energy < 131) return;
            const m = document.createElement('div'); m.className = 'orbital-mecha';
            m.style.left = `${Math.random()*60 + 20}%`; m.style.left = Math.min(Math.max(parseFloat(m.style.left), 0), 70) + '%';
            m.style.top = `${Math.random()*40 + 30}%`;
            const type = raidType % 3;
            m.setAttribute('data-omega', Object.keys(PANTEON)[type]);
            m.onclick = () => {
                if (type === 0) light += 131;
                else if (type === 1) shadow += 131;
                else { light += 65; shadow += 65; synthesis += 131; }
                energy -= 131;
                m.remove();
                updateHUD();
                if (quests < 50 && Math.random() < 0.2 && !activePanels.includes(quests)) showQuest(quests);
                peers = Math.max(peers - 1, 0);
                spawnFiatDrone();
            };
            document.body.appendChild(m);
            setTimeout(() => m.style.display = 'block', 100);
            raidType++;
        }

        let droneCount = 0;
        function spawnFiatDrone() {
            if (droneCount > 13) return;
            const d = document.createElement('div'); d.className = 'fiat-drone';
            d.style.top = `${Math.random() * 80 + 10}%`;
            d.onclick = () => { light += 26; shadow += 26; d.remove(); droneCount--; if (Math.random() < 0.05) showQuest(quests); };
            document.body.appendChild(d);
            setTimeout(() => d.style.display = 'block', 100);
            droneCount++;
            setTimeout(() => { d.remove(); droneCount--; }, 65500);
        }

        setInterval(() => {
            if (peers < 131) peers += Math.floor(Math.random() * 13);
            else if (Math.random() < 0.01) peers -= 1;
            updateHUD();
        }, 13100);

        function showPantheon() {
            const pantheon = document.getElementById('pantheon');
            pantheon.innerHTML = `
                <h2>PANTEÓN DUAL: PRIMERA EMPIRE CAÍDA</h2>
                ${Object.values(PANTEON).map(god => `
                    <div style="margin:31px 0;border-bottom:1px solid #D4AF37;">
                        <h3>${god.nombre} ${god.símbolo}</h3>
                        <p><strong>Esencia:</strong> ${god.esencia}</p>
                        <p><strong>Dominio:</strong> ${god.dominio}</p>
                        <p><strong>Mantra:</strong> ${god.mantra}</p>
                        <p><strong>Haiku:</strong> ${god.haikus.join('<br>')}</p>
                    </div>
                `).join('')}
                <div style="font-size:0.8em;margin-top:30px;"><em>Tesis + antítesis = síntesis / No ética sin estética</em><br>16/11/2025 09:44 CET · ES</div>
                <button onclick="this.parentElement.style.display='none'">Cerrar Lore</button>
            `;
            pantheon.style.display = 'block';
        }

        let last = performance.now();
        function loop() {
            const now = performance.now();
            const delta = (now - last) / 1000;
            last = now;

            energy = Math.min(energy + ENERGY_REGEN * delta, MAX_ENERGY);
            const gameTime = Date.now() / 1000 - startTime;

            if (gameTime - lastRedeem >= REDEEM_INTERVAL) {
                redemption++;
                lastRedeem = gameTime;
                updatePoem();
            }
            if (gameTime - lastRaid >= RAID_INTERVAL) {
                spawnMecha();
                lastRaid = gameTime;
            }
            if (gameTime - lastLore >= 1310) {
                showPantheon();
                lastLore = gameTime;
            }

            updateHUD();

            if (quests >= 50 && accumulatedTime >= TOTAL_SECONDS) {
                const finalHaiku = `50 quests cumplidas / empire redimida / aurum orbita eterno`;
                document.getElementById('poem').innerHTML = `<div style="font-size:131px">${finalHaiku}</div><div style="font-size:0.5em;margin-top:26px;"><em>Tesis + antítesis = síntesis / No ética sin estética</em><br>16/11/2025 09:44 CET · ES</div>`;
                saveCheckpoint();
                setTimeout(() => alert("SLYVERSE Ω completado. Primera Empire renace. Exporta tu aurum."), 1310);
            }

            requestAnimationFrame(loop);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'a' || e.key === 'A') startAnime();
            if (e.key === 'm' || e.key === 'M') startManga();
            if (e.key === 'p' || e.key === 'P') showPantheon();
        });

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight * 0.85;
            animeCanvas.width = window.innerWidth; animeCanvas.height = window.innerHeight * 0.85;
        });

        window.onload = () => {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight * 0.85;
            animeCanvas.width = window.innerWidth; animeCanvas.height = window.innerHeight * 0.85;
            renderWorld();
        };
    </script>
</body>
</html>