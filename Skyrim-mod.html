<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SLYVERSE Ω · Portal Exponencial + Reality #1310 + APIs</title>
<style>
html,body{margin:0;padding:0;height:100vh;overflow:hidden;background:#000;color:#0f0;font-family:'Courier New',monospace;}
#portal{position:absolute;inset:0;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:20px;pointer-events:none;}
.artefacto{width:180px;height:180px;background:#001100;border:2px solid #0f0;border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:auto;cursor:pointer;transition:all .3s;box-shadow:0 0 10px #0f0;filter:drop-shadow(0 0 20px #0f0);}
.artefacto h3{margin:5px;color:#0f0;text-align:center;font-size:1rem;}
.artefacto p{font-size:12px;text-align:center;text-align:center;}
#huds{position:fixed;top:10px;left:10px;color:#0f0;font-size:14px;z-index:1000;}
canvas{position:absolute;inset:0;z-index:-1;}
</style>
</head>
<body>

<div id="portal">
  <div class="artefacto" id="mate"><h3>Mate Sagrado</h3><p>Abrazo 25s, cura 1310 HP</p></div>
  <div class="artefacto" id="boa"><h3>Boa Verde</h3><p>Devora dolor → Luz eterna</p></div>
  <div class="artefacto" id="runas"><h3>Runas Thuamer</h3><p>Lecturas infinitas, feedback visual</p></div>
  <div class="artefacto" id="nina"><h3>NINA Dragón</h3><p>Doma dragones con maullidos cuánticos</p></div>
  <div class="artefacto" id="plaza"><h3>Plaza Infinite</h3><p>Abuelos waving, partículas infinitas</p></div>
  <div class="artefacto" id="bosque"><h3>Bosque Ancestral</h3><p>Susurros binaurales, partículas que respiran</p></div>
  <div class="artefacto" id="orbital"><h3>Orbital Cycle</h3><p>Respira 13.10s, feedback auditivo</p></div>
</div>

<div id="huds">Artefactos conectados: 0 | Reality #1310 Hugs: 0 / 131310</div>
<canvas id="c"></canvas>

<script>
// ===== Motor de partículas avanzado =====
const canvas=document.getElementById('c');
const ctx=canvas.getContext('2d');
canvas.width=innerWidth; canvas.height=innerHeight;
let particles=[];
const MAX_PARTS=1310;
function perlinNoise(x){return (Math.sin(x*12.9898)*43758.5453)%1;}
function initParticles(){
  for(let i=0;i<MAX_PARTS;i++){
    particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*3+1,phase:Math.random()*Math.PI*2,angle:Math.random()*Math.PI*2});
  }
}
function updateParticles(dt){
  for(let p of particles){
    p.phase+=dt*0.001;
    p.angle+=dt*0.0005;
    let nX=perlinNoise(p.x*0.01+p.phase), nY=perlinNoise(p.y*0.01+p.angle);
    p.x+=(Math.cos(p.angle)+nX*2)*0.5;
    p.y+=(Math.sin(p.angle)+nY*2)*0.5;
    if(p.x<0)p.x=canvas.width;if(p.x>canvas.width)p.x=0;
    if(p.y<0)p.y=canvas.height;if(p.y>canvas.height)p.y=0;
  }
}
function drawParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let p of particles){
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle='rgba(0,255,0,0.7)';
    ctx.shadowColor='#0f0';
    ctx.shadowBlur=30;
    ctx.fill();
  }
}
initParticles();
let last=performance.now();
function loop(){
  const now=performance.now();
  const dt=now-last;
  last=now;
  updateParticles(dt);
  drawParticles();
  requestAnimationFrame(loop);
}
loop();

// ===== Hub y sinapsis entre artefactos =====
const hub={connections:0,connected:{}};
const huds=document.getElementById('huds');
const artefactos=['mate','boa','runas','nina','plaza','bosque','orbital'];

// ===== API interna de cada artefacto =====
const APIS={};
artefactos.forEach(id=>{
  APIS[id]={
    boostParticles:function(multiplier){
      for(let i=0;i<50*multiplier;i++){
        particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*3+1,phase:Math.random()*Math.PI*2,angle:Math.random()*Math.PI*2});
      }
    },
    glowEffect:function(intensity){
      let el=document.getElementById(id);
      el.style.boxShadow=`0 0 ${10+intensity*5}px #0f0`;
      el.style.transform=`scale(${1+intensity*0.05})`;
    },
    interactWith:function(otherID){
      if(APIS[otherID]){
        this.boostParticles(1);
        APIS[otherID].glowEffect(1);
      }
    }
  };
});

// ===== Conectar artefactos y activar APIs =====
function connectArtefact(id){
  if(!hub.connected[id]){
    hub.connected[id]=true;
    hub.connections++;
    // Cada artefacto potencia todos los conectados
    Object.keys(hub.connected).forEach(other=>{
      APIS[id].interactWith(other);
    });
    updateHUD();
  }
}
function updateHUD(){
  huds.textContent=`Artefactos conectados: ${hub.connections} | Reality #1310 Hugs: ${game.hugs} / 131310`;
}

// Bind clicks
artefactos.forEach(id=>document.getElementById(id).onclick=()=>connectArtefact(id));

// ===== Juego Reality #1310 mejorado =====
const game={hugs:0};
setInterval(()=>{
  let increment=Math.floor(Math.random()*10)+hub.connections*2; // Exponencial con artefactos
  game.hugs+=increment;
  if(game.hugs>131310) game.hugs=131310;
  updateHUD();
},2000);

// ===== Audio procedural y mic opcional =====
let audioCtx=new (window.AudioContext||window.webkitAudioContext)();
let gain=audioCtx.createGain(); gain.gain.value=0.03; gain.connect(audioCtx.destination);
function proceduralTone(freq,duration=0.15){
  let osc=audioCtx.createOscillator();
  osc.type='sine';
  osc.frequency.value=freq;
  osc.connect(gain);
  osc.start();
  osc.stop(audioCtx.currentTime+duration);
}
if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia){
  navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{
    const analyser=audioCtx.createAnalyser();
    const source=audioCtx.createMediaStreamSource(stream);
    source.connect(analyser);
    const data=new Uint8Array(analyser.frequencyBinCount);
    setInterval(()=>{
      analyser.getByteFrequencyData(data);
      let avg=data.reduce((a,b)=>a+b,0)/data.length;
      if(avg>50 && hub.connections>0){
        proceduralTone(200+avg*2,0.1);
        Object.keys(hub.connected).forEach(id=>APIS[id].boostParticles(1));
      }
    },100);
  }).catch(()=>{});
}

// ===== Feedback visual dinámico =====
setInterval(()=>{
  Object.keys(hub.connected).forEach(id=>APIS[id].glowEffect(Math.random()*hub.connections));
},5000);
</script>
</body>
</html>
