<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Respiro — para Joaquín y para todos los que están jodidos</title>
<meta name="description" content="Un rinconcito muy lento y muy seguro. Inspirado en Joaquín Sabina y en el perro verde.">
<style>
  body,html{margin:0;height:100%;overflow:hidden;background:#000;font-family:"Courier New",monospace;color:#fff}
  canvas{display:block}
  #frase{position:fixed;bottom:60px;left:50%;transform:translateX(-50%);font-size:19px;text-align:center;opacity:0;transition:opacity 3s;pointer-events:none;z-index:10;line-height:1.8}
  #mate{position:fixed;bottom:40px;right:40px;width:90px;height:90px;border-radius:50%;background:radial-gradient(#ff8c00,#8b0000);box-shadow:0 0 50px #ff4500;display:flex;align-items:center;justify-content:center;font-size:50px;cursor:pointer;z-index:20;opacity:0.8;transition:.4s}
  #mate:hover{opacity:1;transform:scale(1.15)}
  #dedicatoria{position:fixed;top:20px;left:20px;font-size:13px;opacity:0.4;pointer-events:none}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="dedicatoria">
  Para Joaquín Sabina<br>
  y para el perro verde<br>
  y para todos los que están jodidos<br>
  (un pibe de Sabadell, 2025)
</div>

<div id="frase"></div>
<div id="mate" role="button" aria-label="Abrazo sabinero">Abrazo</div>

<script>
const c = document.getElementById('c');
const ctx = c.getContext('2d');
let w = c.width = innerWidth, h = c.height = innerHeight;
window.onresize = ()=>{w=c.width=innerWidth; h=c.height=innerHeight;};

let t = 0;
let breath = 0;
let hugs = parseInt(localStorage.getItem('sabinaHugs')||'0');

const frasesSabina = [
  "está bien estar cansado",
  "no tenés que ser fuerte todo el tiempo",
  "yo no soy de izquierdas ni de derechas, soy de los que están jodidos",
  "la libertad de amar es lo único que nos queda",
  "prefiero ser un perdedor honrado que un ganador sin alma",
  "acá nadie te apura",
  "tus sentimientos son válidos",
  "está permitido descansar",
  "no estás solo, Joaquín está cantando en algún bar",
  "mañana también va a salir el sol… aunque sea de resaca",
  "te banco, aunque no me conozcas",
  "todo va a estar bien, de verdad",
  "la esperanza es lo último que se pierde… y lo primero que se encuentra en una buena canción"
];

function mostrarFrase(){
  const f = document.getElementById('frase');
  f.textContent = frasesSabina[Math.floor(Math.random()*frasesSabina.length)];
  f.style.opacity = 1;
  setTimeout(()=>{f.style.opacity = 0;}, 9000);
}

document.getElementById('mate').onclick = ()=>{
  hugs++;
  localStorage.setItem('sabinaHugs',hugs);
  breath = 0;
  mostrarFrase();
  if("vibrate" in navigator) navigator.vibrate([120,180,120]);
  // easter egg a los 1313 abrazos
  if(hugs === 1313){
    alert("1313 abrazos…\nJoaquín te manda un abrazo desde algún bar de Madrid.\nY el perro verde ladra orgulloso.");
  }
};

function loop(){
  t += 0.004;

  // respiración lenta, como después de un trago largo
  breath += 0.0015;
  if(breath>1) breath = 0;
  const ease = breath<0.5 ? 2*breath*breath : 1-(Math.pow(-2*breath+2,2)/2);

  // cielo de bar a las 5 a.m.
  const grad = ctx.createLinearGradient(0,0,0,h);
  grad.addColorStop(0, `hsl(${180+ease*60},50%,${8+ease*12}%)`);
  grad.addColorStop(1, `hsl(${240+ease*40},30%,${3+ease*6}%)`);
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,w,h);

  // humo de cigarro que sube lento
  for(let i=0;i<80;i++){
    const x = w/2 + Math.sin(t*0.3+i)*200;
    const y = h - (t*30+i*40)%(h*1.5);
    const size = 10 + ease*40;
    ctx.fillStyle = `rgba(220,220,230,${0.03+ease*0.05})`;
    ctx.beginPath(); ctx.arc(x,y,size,0,Math.PI*2); ctx.fill();
  }

  // luna roja de resaca que respira
  const moonX = w*0.75;
  const moonY = h*0.25;
  const moonSize = 70 + ease*40;
  ctx.fillStyle = `rgba(255,140,0,${0.4+ease*0.3})`;
  ctx.beginPath(); ctx.arc(moonX,moonY,moonSize,0,Math.PI*2); ctx.fill();

  requestAnimationFrame(loop);
}

mostrarFrase();
loop();
</script>
</body>
</html>