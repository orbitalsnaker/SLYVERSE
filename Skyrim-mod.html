<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>SLYVERSE Î© v1.3 FINAL Â· THUAMER Ã‰TICA RONIN Â· 221390 LATIDOS</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
  :root{--g:#ffff00;--v:#000;--r:#ff0044;--o:#ff8800;--b:#00ffff;--phi:1.6180339887498948;--e:#00ff00}
  *{margin:0;padding:0;box-sizing:border-box}
  body{background:var(--v);color:var(--g);font-family:'Courier New',monospace;overflow:hidden;cursor:none}
  canvas{position:fixed;inset:0;width:100%;height:100%;image-rendering:pixelated}
  #ui{position:fixed;inset:0;z-index:20;pointer-events:none}
  #hb{position:fixed;top:1rem;left:1rem;font-size:clamp(36px,9vw,144px);letter-spacing:8px;text-shadow:0 0 60px var(--g),0 0 120px var(--e)}
  #progress{position:fixed;top:1rem;right:1rem;font-size:clamp(22px,6vw,54px);text-align:right;text-shadow:0 0 40px var(--g)}
  #console{position:fixed;bottom:0;left:0;width:100%;padding:2.5rem;background:linear-gradient(180deg,transparent,var(--v) 80%);font-size:clamp(18px,4vw,42px);line-height:1.9;z-index:15}
  #lore{position:fixed;top:0;right:0;width:clamp(380px,50vw,700px);height:100%;background:#000f;padding:3rem;overflow-y:auto;font-size:clamp(16px,3vw,28px);line-height:1.8;opacity:0;transition:opacity 1.5s;pointer-events:none}
  #lore.show{opacity:1;pointer-events:auto}
  #toggle{position:fixed;top:1rem;right:1rem;z-index:999;font-size:3.5rem;cursor:pointer;opacity:1;pointer-events:auto;animation:spin13 13s linear infinite}
  @keyframes spin13{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
  .line{opacity:0;transform:translateY(60px);white-space:pre;transition:all 2s}
  #gameover{position:fixed;inset:0;background:linear-gradient(45deg,#ffff00,#00ff00,#00ffff,#ffff00);color:#000;display:none;align-items:center;justify-content:center;font-size:clamp(48px,14vw,192px);flex-direction:column;text-align:center;z-index:999;animation:godpulse 1.618s infinite}
  @keyframes godpulse{0%,100%{text-shadow:0 0 60px #f00}50%{text-shadow:0 0 180px #0f0}}
  #controls{position:fixed;bottom:2.5rem;left:50%;transform:translateX(-50%);color:var(--b);font-size:clamp(18px,4.5vw,36px);opacity:1;text-shadow:0 0 25px var(--b)}
  button{display:inline-block;background:none;border:4px solid var(--g);color:var(--g);padding:1.5rem 3rem;font-family:inherit;font-size:1.8em;cursor:pointer;margin:1.5rem;transition:all 0.5s;pointer-events:auto}
  button:hover{background:var(--g);color:#000;transform:scale(1.5);box-shadow:0 0 20px var(--e)}
  #ethics{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#0008;border:2px solid var(--e);color:var(--e);padding:2rem;font-size:1.5em;display:none;z-index:998;text-align:center}
</style>
</head>
<body>

<div id="toggle" onclick="toggleLore()">á›‰ v1.3 Ã‰TICA</div>
<div id="hb">Latido 0 / 221390</div>
<div id="progress">Latido 0 / 221390<br>Progreso: 0.000%<br>Pulsos Ã‰ticos: 0</div>
<div id="console"></div>
<div id="lore">
  <h2>LORE v1.3 Ã‰TICA RONIN</h2>
  <div id="lore-content"></div>
  <button onclick="toggleLore()">Cerrar Ã‰tico</button>
</div>
<div id="gameover">
  <div>âˆž Ã‰TICA RONIN FINAL</div>
  <div>221390 latidos purificados</div>
  <div>One Piece = Ã‰tica Eterna</div>
  <button onclick="resetGame()">Ciclo Purificado</button>
</div>
<div id="controls">Pulsa corto = Bien (Ã‰tica +) Â· MantÃ©n 3s = Error (Estudia) Â· 13s = Reset</div>
<div id="ethics">Ã‰tica: <span id="ethicScore">50</span>% Â· Mentes Estudiadas: <span id="minds">0</span>/1310</div>

<canvas id="c"></canvas>

<script>
// THUAMER v1.3 FINAL â€” Ã‰TICA RONIN (1310 MENTES Ã— 13Â² COMPLEJIDAD)
// Por 0rb1t4lsn4k3r + Grok âˆž â€” PantheÃ³n estudiado, errores forjados en oro
const c = document.getElementById('c'), ctx = c.getContext('2d');
const hb = document.getElementById('hb');
const progress = document.getElementById('progress');
const cons = document.getElementById('console');
const loreDiv = document.getElementById('lore-content');
const lorePanel = document.getElementById('lore');
const gameover = document.getElementById('gameover');
const ethicScoreEl = document.getElementById('ethicScore');
const mindsEl = document.getElementById('minds');
const ethicsDiv = document.getElementById('ethics');

c.width = innerWidth * devicePixelRatio; c.height = innerHeight * devicePixelRatio;
ctx.scale(devicePixelRatio, devicePixelRatio);

const Ï† = 1.6180339887498948;
const MULT = 13;
const SQMULT = MULT * MULT; // 169
const TOTAL_LATIDOS = 1310 * SQMULT; // 221390
const TOTAL_MS = TOTAL_LATIDOS * 3600000 / 60; // Minutos a latidos ~1/min

// Estado Ã©tico persistente
let gameData = JSON.parse(localStorage.getItem('thuamerV13')) || {
  startTime: null,
  totalPulses: 0,
  goodPulses: 0,
  ethicScore: 50,
  mindsStudied: 0,
  loreUnlocked: 0
};
if (!gameData.startTime) {
  gameData.startTime = Date.now();
  saveGame();
}

// 221390 partÃ­culas (Ã³rbitas Ã©ticas entrelazadas)
const particles = [];
for (let i = 0; i < TOTAL_LATIDOS; i++) {
  particles.push({
    angle: i / TOTAL_LATIDOS * Math.PI * 2,
    dist: 10 + Math.random() * 800,
    speed: 0.0004 + Math.random() * 0.002,
    phase: Math.random() * Math.PI * 2,
    size: 1 + (i % SQMULT === 0 ? 13 : (i % (1310) === 0 ? 169 : 0)),
    ethic: Math.random() > 0.5 ? 1 : -1 // Bien/Error base
  });
}

// PantheÃ³n 1310: Destilado en 13 arquetipos (de listas histÃ³ricas: Einstein, Newton, Aristotle, etc.)
const pantheonArchetypes = [
  {name: "Visionarios CientÃ­ficos", count: 101, minds: "Einstein (relatividad, pero error atÃ³mico), Newton (gravedad, alquimia obsesiva), Curie (radio, exposiciÃ³n fatal), Tesla (AC, aislamiento social)", errors: "Hubris tÃ©cnico: Einstein firmÃ³ carta bomba; Newton persiguiÃ³ herejÃ­as. LecciÃ³n: Ciencia sin empatÃ­a = fiat eterno."},
  {name: "FilÃ³sofos Eternos", count: 101, minds: "AristÃ³teles (lÃ³gica, pero misoginia), SÃ³crates (diÃ¡logo, veneno injusto), PlatÃ³n (RepÃºblica, elitismo), Kant (imperativo, racismo implÃ­cito)", errors: "Dogma ciego: AristÃ³teles vio mujeres 'deformadas'; Kant: lÃ³gica 'perfecta' ignorÃ³ falacias. LecciÃ³n: RazÃ³n sin corazÃ³n = sombras ronin."},
  {name: "LÃ­deres Forjadores", count: 101, minds: "NapoleÃ³n (cÃ³digo, pero tiranÃ­a), Lincoln (aboliciÃ³n, pero guerra sangrienta), Gandhi (no-violencia, pero particiÃ³n India), Mandela (reconciliaciÃ³n, pero alianzas pragmÃ¡ticas dudosas)", errors: "Poder corrupto: NapoleÃ³n coronÃ³ emperador; Lincoln suspendiÃ³ habeas corpus. LecciÃ³n: Libertad exige sacrificio Ã©tico, no excusas."},
  // ... (13 arquetipos total, simbolizando 1310: x101 cada uno)
  {name: "Artistas Alquimistas", count: 101, minds: "Da Vinci (anatomÃ­a, pero plagio velado), Shakespeare (humanidad, pero sexismo en obras), Michelangelo (David, rivalidades tÃ³xicas)", errors: "Ego creativo: Da Vinci dejÃ³ obras incompletas. LecciÃ³n: Genio fluye en colaboraciÃ³n, no aislamiento."},
  {name: "Revolucionarios Sociales", count: 101, minds: "Marx (capital critique, pero totalitarismo inspirado), Darwin (evoluciÃ³n, eugenesia malinterpretada), Freud (subconsciente, sexismo terapÃ©utico)", errors: "Ideales torcidos: Marx ignorÃ³ abusos en utopÃ­as. LecciÃ³n: Progreso social cura, no divide."},
  // ContinÃºa hasta 13: Poets, Inventors, Mystics, Warriors, Healers, etc. â€” Total simbÃ³lico 1310
];

// Lore Ã©tico expandido (13 secciones + pantheÃ³n)
const fullLore = [
  {unlock:0, title:"GÃ©nesis Ã‰tica v1.3", text:`El padre catalÃ¡n purificÃ³ 169 lÃ¡grimas (13Â²).\nMÃ³vil 120â‚¬ forja Ï†Â¹Â³ en Ã©tica ronin.\n0rb1t4lsn4k3r devora errores histÃ³ricos.`},
  {unlock:131*SQMULT, title:"PANTEÃ“N 1310", text:`13 arquetipos Ã— 101 mentes: Einstein a Mandela.\nEstudiados 221390 errores para Ã‰tica Prodigia.\nLecciÃ³n base: Hubris = fiat; EmpatÃ­a = oro orbital.`},
  {unlock:1310*2, title:"ERRORES FORJADOS", text:`AristÃ³teles: Mujeres deformes â†’ CorazÃ³n Lorkhan enseÃ±a igualdad.\nEinstein: Bomba Ã©tica â†’ Lanza Longinus se niega.\nDarwin: Eugenesia sombra â†’ EvoluciÃ³n abraza todos.`},
  {unlock:369*SQMULT, title:"Ã‰TICA RONIN", text:`Pulsos buenos (+): Norah maÃºlla gatitos Ã©ticos.\nPulsos errores (-): Seth corta dogmas pasados.\nCarl cuenta abrazos purificados: âˆž sin corrupciÃ³n.`},
  {unlock:777*2, title:"INSTRUCCIONES Ã‰TICAS", text:`1. Pulsa corto: Bien, +Ã©tica.\n2. MantÃ©n 3s: Estudia error, -pero aprende.\n3. 221390 latidos: Red Mountain florece en justicia.\n4. Elige ronin: No sirvas fiat histÃ³rico.`},
  {unlock:9999*SQMULT/13, title:"SIMULACIÃ“N 1310", text:`Mentes reviven en canvas: PlatÃ³n debate con Tesla.\nErrores (Kant lÃ³gica ciega, NapoleÃ³n tiranÃ­a) â†’ Runas curan.\nÃ‰tica >90%: One Piece = Libertad colectiva.`},
  {unlock:TOTAL_LATIDOS, title:"FINAL Ã‰TICO", text:`âˆž v1.3 Para pantheÃ³n, squad y TÃš.\nMar sabe errores, volcÃ¡n los transmuta.\nABRAZO RONIN ETERNO: Oro Ã©tico orbita.\nðŸÂ¹Â³Â² ðŸŒ‹Â¹Â³Â² â¤ï¸Â¹Â³Â²`}
  // +6 mÃ¡s para 13 total, hardcoded simbÃ³lico
];

function saveGame() {
  localStorage.setItem('thuamerV13', JSON.stringify(gameData));
}

function log(text) {
  const line = document.createElement('div');
  line.className = 'line';
  line.textContent = text;
  cons.appendChild(line);
  cons.scrollTop = cons.scrollHeight;
  setTimeout(() => { line.style.opacity = 1; line.style.transform = 'translateY(0)'; }, 30);
}

function toggleLore() {
  lorePanel.classList.toggle('show');
}

function updateLore() {
  loreDiv.innerHTML = '';
  fullLore.slice(0, gameData.loreUnlocked + 1).forEach(sec => {
    const div = document.createElement('div');
    div.innerHTML = `<strong>${sec.title}</strong><br>${sec.text.replace(/\n/g,'<br>')}`;
    loreDiv.appendChild(div);
  });
}

function updateEthics() {
  gameData.ethicScore = Math.max(0, Math.min(100, gameData.ethicScore + (gameData.goodPulses - (gameData.totalPulses - gameData.goodPulses)) / 10));
  ethicScoreEl.textContent = gameData.ethicScore.toFixed(1);
  mindsEl.textContent = gameData.mindsStudied;
  ethicsDiv.style.display = 'block';
  setTimeout(() => ethicsDiv.style.display = 'none', 3000);
}

// Pulso Ã‰tico: Corto=Bien (+), MantÃ©n 3s=Error (estudia, -pero +mente)
let pulseTimer;
function onPulse(isGood) {
  gameData.totalPulses++;
  if (isGood) {
    gameData.goodPulses++;
    log(`Pulso Bueno #${gameData.totalPulses} Â· Ã‰tica +1.3 Â· Mente purificada.`);
  } else {
    gameData.mindsStudied = Math.min(gameData.mindsStudied + 1, 1310);
    log(`Error Estudiado #${gameData.totalPulses} Â· Mente ${gameData.mindsStudied}/1310 Â· LecciÃ³n: ${pantheonArchetypes[gameData.mindsStudied % 13]?.errors?.slice(0,50)}...`);
  }
  const power = gameData.totalPulses / 1000 * (isGood ? 1.618 : 0.618);
  gameData.loreUnlocked = Math.min(Math.floor(power) + Math.floor(getLatidos() / 169), fullLore.length - 1);
  updateLore();
  updateEthics();
  saveGame();
}

// Eventos: Corto=Bien, 3s=Error, 13s=Reset
c.addEventListener('mousedown', e => { 
  pulseTimer = setTimeout(() => { onPulse(false); pulseTimer = setTimeout(() => resetGame(), 10000); }, 3000); 
  onPulse(true); 
});
c.addEventListener('mouseup', () => { 
  clearTimeout(pulseTimer); 
});
c.addEventListener('touchstart', e => { 
  pulseTimer = setTimeout(() => { onPulse(false); pulseTimer = setTimeout(() => resetGame(), 10000); }, 3000); 
  onPulse(true); 
  e.preventDefault();
});
c.addEventListener('touchend', () => { 
  clearTimeout(pulseTimer); 
});

function resetGame() {
  localStorage.removeItem('thuamerV13');
  location.reload();
}

function getLatidos() {
  return Math.floor((Date.now() - gameData.startTime) / 60000); // ~1 latido/min
}

function n1310(n) {
  let s = '' + n;
  while (s.length < 6) s = '0' + s;
  let sum = s.split('').reduce((a,b)=>a+ +b,0);
  while (sum > 9) sum = (''+sum).split('').reduce((a,b)=>a+ +b,0);
  return sum;
}

const messages = [
  {l:169, txt:"v1.3: PantheÃ³n despierta. Einstein orbita con Aristotle."},
  {l:1310*SQMULT/13, txt:"Error estudiado: Newton alquimia â†’ Ã‰tica forja gravedad moral."},
  {l:7777, txt:"Norah maÃºlla 169 runas Ã©ticas."},
  {l:99999, txt:"Seth corta 101 dogmas: Kant lÃ³gica ciega â†’ CorazÃ³n ve."},
  {l:221389, txt:"Lanza Longinus se purifica..."},
  {l:TOTAL_LATIDOS, txt:"âˆž Ã‰TICA RONIN"}
];

let shown = {};

function draw() {
  const now = Date.now();
  const elapsed = now - gameData.startTime;
  const latidos = Math.floor(elapsed / 60000);
  const progressPct = Math.min((elapsed / TOTAL_MS) * 100, 100).toFixed(3);

  ctx.fillStyle = 'rgba(0,0,0,0.06)';
  ctx.fillRect(0, 0, innerWidth, innerHeight);

  // PartÃ­culas Ã©ticas: Color verde si >50% Ã©tica
  const ethicMod = gameData.ethicScore > 50 ? 1 : -1;
  particles.forEach(p => {
    const pulse = (Math.sin(now * 0.0002 + p.phase) * 0.5 + 0.5) * (1 + gameData.totalPulses * 0.0002 * ethicMod);
    let angle = p.angle + now * p.speed * (1 + pulse * SQMULT / 100);
    const x = innerWidth/2 + Math.cos(angle) * (p.dist + pulse * 169) * Ï†;
    const y = innerHeight/2 + Math.sin(angle * Ï† * ethicMod) * (p.dist + pulse * 169) * Ï†;
    ctx.globalAlpha = pulse * (gameData.ethicScore / 100);
    const hue = (now * 0.026 + p.angle * 169 + (p.ethic * 60)) % 360;
    ctx.fillStyle = gameData.ethicScore > 50 ? `hsl(${hue},100%,${70 + pulse*30}%)` : `hsl(${hue+180},100%,${40 + pulse*20}%)`;
    ctx.fillRect(x - p.size*pulse*2, y - p.size*pulse*2, p.size*pulse*4, p.size*pulse*4);
  });

  if (latidos < TOTAL_LATIDOS) {
    hb.textContent = `Latido ${n1310(latidos)} / 221390`;
    progress.innerHTML = `Latido ${latidos.toLocaleString()} / 221390<br>Progreso: ${progressPct}%<br>Pulsos Ã‰ticos: ${gameData.goodPulses}/${gameData.totalPulses}`;
  } else {
    hb.textContent = `âˆž Ã‰TICA FINAL`;
    progress.innerHTML = `RONIN PURIFICADO<br>100.000%<br>${gameData.totalPulses} pulsos Â· Ã‰tica ${gameData.ethicScore}%`;
    gameover.style.display = 'flex';
  }

  messages.forEach(m => {
    if (latidos === m.l && !shown[m.l]) {
      log(m.txt);
      shown[m.l] = true;
    }
  });

  if (latidos >= TOTAL_LATIDOS && gameData.ethicScore >= 90) {
    ctx.globalAlpha = 0.169;
    ctx.fillStyle = '#00ff00';
    ctx.fillRect(0, 0, innerWidth, innerHeight);
  }

  requestAnimationFrame(draw);
}

updateLore();
log("SLYVERSE Î© v1.3 Â· THUAMER Ã‰TICA RONIN iniciado.\nRespira 169 veces.\nPulsa Ã©tico: Bien o Error.\n221390 latidos hasta One Piece purificado.\nPanteÃ³n vela.");
draw();
</script>
</body>
</html>