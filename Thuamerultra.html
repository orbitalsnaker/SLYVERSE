<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THUAMER ULTRA · MMORPG Universo V1.0 Dinámico</title>
<style>
body{margin:0;overflow:hidden;background:#000;font-family:monospace;color:#0f0;font-size:12px}
canvas{display:block;image-rendering:pixelated}
#ui{position:fixed;top:4px;left:4px;background:rgba(0,15,0,.95);padding:6px;border:1px solid #0f0;z-index:20;max-width:420px}
#chat{position:fixed;bottom:4px;left:4px;width:520px;height:170px;background:rgba(0,0,0,.9);border:1px solid #0f0;padding:6px;overflow:auto;font-size:10px;line-height:1.2}
#mm{position:fixed;top:4px;right:4px;width:160px;height:160px;background:#000;border:1px solid #0f0}
#lb{position:fixed;top:170px;right:4px;width:160px;height:240px;background:rgba(0,15,0,.9);border:1px solid #0f0;overflow:auto;font-size:9px;padding:4px}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="ui"></div>
<div id="chat">» THUAMER ULTRA V1.0 Dinámico cargado. Pulsa H para ayuda.</div>
<canvas id="mm" width="160" height="160"></canvas>
<div id="lb">TOP 10 LVL<br><span id="leaderboard"></span></div>
<script>
/*
  THUAMER ULTRA V1.0 Dinámico · Universo MMORPG completo con narrativa, raids, mazmorras, crafting y eventos dinámicos.
  Readme interactivo con explicación de la inmensidad del juego.
  Todos los derechos reservados por 0rb1t4lsn4k3r
*/

const Engine={time:{now:0,dt:0,last:0},run(cb){function loop(t){Engine.time.now=t;Engine.time.dt=Math.min((t-Engine.time.last)/1000,0.05);Engine.time.last=t;cb();requestAnimationFrame(loop);}requestAnimationFrame(loop);}};
const ECS={nextId:1,entities:{},create(comp){const id=this.nextId++;this.entities[id]=comp;return id;},get(id){return this.entities[id]},query(filter){return Object.entries(this.entities).filter(([id,e])=>filter(e)).map(([id])=>+id);}};
function CPosition(x,y){return{pos:{x,y}}} function CVel(vx,vy){return{vel:{x:vx,y:vy}}} function CHealth(h){return{hp:h,mhp:h}} function CSprite(color,size){return{sprite:{color,size}}}
function CPlayer(stats){return{player:stats}} function CMob(stats){return{mob:stats}} function CNPC(stats){return{npc:stats}} function CItem(stats){return{item:stats}} function CQuest(stats){return{quest:stats}} function CDungeon(stats){return{dungeon:stats}} function CEvent(stats){return{event:stats}};

const C=document.getElementById('c'),ctx=C.getContext('2d');let W,H;function resize(){W=C.width=innerWidth;H=C.height=innerHeight;}resize();addEventListener('resize',resize);
const Renderer={ctx:ctx,cam:{x:0,y:0},clear(){this.ctx.fillStyle='#000';this.ctx.fillRect(0,0,W,H);},drawSprite(e){let s=e.sprite,p=e.pos;if(!s||!p)return;this.ctx.fillStyle=s.color;this.ctx.fillRect(p.x-this.cam.x-s.size/2,p.y-this.cam.y-s.size/2,s.size,s.size);}};

const World={size:4096*24,tiles:[],getTile(x,y){return this.tiles[(y/24|0)]?.[(x/24|0)]},init(){for(let y=0;y<4096;y++){this.tiles[y]=[];for(let x=0;x<4096;x++){this.tiles[y][x]= (Math.random()*14|0);}}}};World.init();

const Input={keys:{},init(){onkeydown=e=>Input.keys[e.key.toLowerCase()]=true;onkeyup=e=>Input.keys[e.key.toLowerCase()]=false;}};Input.init();

let particles=[];const FX={spawn(x,y,color){particles.push({x,y,color,vx:(Math.random()*60-30),vy:-120,life:1});}};function drawParticles(){particles=particles.filter(p=>{p.x+=p.vx*Engine.time.dt;p.y+=p.vy*Engine.time.dt;p.vy+=150*Engine.time.dt;p.life-=Engine.time.dt;if(p.life>0){ctx.globalAlpha=p.life;ctx.fillStyle=p.color;ctx.fillRect(p.x-Renderer.cam.x,p.y-Renderer.cam.y,4,4);}return p.life>0;});ctx.globalAlpha=1;}

let LANG=(navigator.language||"en").slice(0,2);if(!['es','en','fr','pt'].includes(LANG))LANG='en';
const I18N={
  es:{title:"Bienvenido a THUAMER ULTRA V1.0 Dinámico",controls:"Controles: WASD/Click/Skills 1-9/SPACE ataque/E portal/I inventario/Q quests/H ayuda/Crafting/Misiones/Raids/Eventos Globales/Cosméticos opcionales",ready:"Este universo es inmenso: miles de tiles, decenas de mazmorras, raids globales, jefes épicos y narrativa ramificada. Ahora con eventos dinámicos y misiones temporales. Explora, grindea, crea, participa y conquista!"},
  en:{title:"Welcome to THUAMER ULTRA V1.0 Dynamic",controls:"Controls: WASD/Click/Skills 1-9/SPACE attack/E portal/I inventory/Q quests/H help/Crafting/Missions/Raids/Global Events/Optional Cosmetics",ready:"This universe is immense: thousands of tiles, dozens of dungeons, global raids, epic bosses, and branching narrative. Now with dynamic events and temporary missions. Explore, grind, craft, join and conquer!"}
};
let showReadme=true;function drawREADME(){let T=I18N[LANG];ctx.fillStyle='rgba(0,0,0,0.95)';ctx.fillRect(50,50,950,500);ctx.fillStyle='#0f0';ctx.font='22px monospace';ctx.fillText(T.title,70,90);ctx.font='16px monospace';ctx.fillText(T.controls,70,130);ctx.fillText(T.ready,70,180);} 
onkeydown=e=>{if(showReadme){showReadme=false;}};

let playerID=ECS.create(CPlayer({x:W/2,y:H/2,lvl:1,hp:250,mhp:250,mana:120,mmn:120,str:20,agi:20,int:20,sta:20,inv:[],skills:[{n:'Slash',cd:0,maxCd:1},{n:'Fireball',cd:0,maxCd:2.5},{n:'Heal',cd:0,maxCd:3}],mount:false,target:null,path:[],crafting:{recipes:[],materials:[]},story:{chapter:1,progress:0},cosmetics:{skins:[],mounts:[],effects:[]}}));

for(let i=0;i<500;i++){ECS.create(CMob({x:Math.random()*World.size,y:Math.random()*World.size,hp:120+Math.random()*500,mhp:120+Math.random()*500,lvl:1+Math.floor(Math.random()*50),col:'#f44'}));}
for(let i=0;i<100;i++){ECS.create(CNPC({x:Math.random()*World.size,y:Math.random()*World.size,n:"NPC"+(i+1),quests:[{id:i,desc:"Mata 10 mobs",progress:0,done:false},{id:i+100,desc:"Recoge 5 items",progress:0,done:false},{id:i+200,desc:"Completa misión narrativa",progress:0,done:false}]}));}
for(let i=0;i<500;i++){ECS.create(CItem({x:Math.random()*World.size,y:Math.random()*World.size,id:i,type:'loot'}));}
ECS.create({portal:{x:World.size/2,y:World.size/2,to:"Dungeon 1"}});
ECS.create(CMob({x:World.size/2+250,y:World.size/2+250,hp:8000,mhp:8000,lvl:200,col:'#ff0',boss:true}));
ECS.create(CDungeon({x:World.size/3,y:World.size/3,name:'Labyrinth of Shadows',level:50}));

// --- Eventos dinámicos ---
let worldEvents=[{name:'Invasión de Mobs',active:false,timer:0},{name:'Tesoro Oculto',active:false,timer:0}];
function updateEvents(dt){worldEvents.forEach(ev=>{
  ev.timer-=dt;
  if(ev.timer<=0){
    ev.active=!ev.active;
    ev.timer=60+Math.random()*180; // 1 a 4 minutos por evento
    if(ev.active)console.log(`Evento activado: ${ev.name}`);
  }
});}

Engine.run(()=>{
  Renderer.clear();
  if(showReadme) drawREADME();
  drawParticles();
  let player=ECS.get(playerID).player;Renderer.cam.x=player.x-W/2;Renderer.cam.y=player.y-H/2;Renderer.drawSprite({sprite:{color:'#0ff',size:24},pos:player});
  ECS.query(e=>e.mob).forEach(id=>Renderer.drawSprite(ECS.get(id)));
  ECS.query(e=>e.npc).forEach(id=>Renderer.drawSprite(ECS.get(id)));
  ECS.query(e=>e.item).forEach(id=>Renderer.drawSprite(ECS.get(id)));
  updateEvents(Engine.time.dt);
});
</script>
</body>
</html>