<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>1310 Â· El abrazo que nunca termina</title>
<style>
  *,*::before,*::after{box-sizing:border-box}
  body,html{margin:0;height:100%;overflow:hidden;background:#000;color:#0f8;font-family:"Courier New",monospace;cursor:none;user-select:none}
  canvas{position:fixed;inset:0;display:block}
  .t,{position:fixed;top:3vh;left:3vw;font-size:clamp(11px,1.7vw,17px);opacity:0;line-height:2;transition:all 2s}
  .h{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:clamp(40px,15vw,140px);opacity:0.19;letter-spacing:12px;white-space:nowrap}
  .p{position:fixed;bottom:3vh;left:50%;transform:translateX(-50%);font-size:clamp(13px,2.2vw,21px);opacity:0.82;text-align:center;line-height:1.8}
  
  /* Capas sucesivas */
  #monkey,#gift{display:none;position:fixed;inset:0;background:#000;color:#0f8;font-size:clamp(1.2rem,3.2vw,4.5rem);line-height:1.9;
          place-items:center;text-align:center;padding:8vw;text-shadow:0 0 30px #0f8;opacity:0}
  #monkey pre,#gift pre{margin:0;animation:breath 13s infinite}
  @keyframes breath{0%,100%{opacity:.74;transform:scale(.985)}50%{opacity:1;transform:scale(1)}}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div class="t" id="t"></div>
<div class="h">Snake Heart Light</div>
<div class="p" id="p"></div>

<!-- Capa 2 Â· El mono y el humo (mÃ¡s bello que nunca) -->
<div id="monkey"><pre id="monkeytext"></pre></div>

<!-- Capa 3 Â· El regalo final (belleza absoluta) -->
<div id="gift"><pre id="gifttext"></pre></div>

<script>
// 1310 abrazos de luz Â· motor tÃ©cnico mÃ¡ximo (mismo que antes, pero ahora respira belleza)
const TARGET=1310, KEY='orb1310', SOUL='orb_soul';
let start=performance.now(), saved=parseFloat(localStorage.getItem(KEY)||'0');
let soul=localStorage.getItem(SOUL)||'âˆž'+crypto.randomUUID().slice(-8);
localStorage.setItem(SOUL,soul);

const $t=document.getElementById('t'), $p=document.getElementById('p');
const $monkey=document.getElementById('monkey'), $monkeytext=document.getElementById('monkeytext');
const $gift=document.getElementById('gift'), $gifttext=document.getElementById('gifttext');

// Canvas: ahora las partÃ­culas son almas que ascienden como luciÃ©rnagas verdes-doradas
const c=document.getElementById('c');
const x=c.getContext('2d',{alpha:true,desynchronized:true});
let W=c.width=innerWidth*devicePixelRatio, H=c.height=innerHeight*devicePixelRatio;
c.style.width=innerWidth+'px';c.style.height=innerHeight+'px';x.scale(devicePixelRatio,devicePixelRatio);

class Soul{
  constructor(){this.reset()}
  reset(){
    this.x=Math.random()*innerWidth;this.y=innerHeight+40;
    this.vy=-(Math.random()*1.6+0.7);this.r=Math.random()*2.8+1.4;
    this.hue=90+Math.random()*40;this.o=0;this.targetO=0.5+Math.random()*0.4;
    this.trail=[];this.life=0
  }
  update(){
    this.life++;this.y+=this.vy;this.o+=(this.targetO-this.o)*0.04;
    this.trail.push({x:this.x,y:this.y});if(this.trail.length>24)this.trail.shift();
    if(this.y<-60)this.reset()
  }
  draw(){
    this.trail.forEach((p,i)=>{x.globalAlpha=(i/this.trail.length)*this.o*0.5;
      x.fillStyle=`hsl(${this.hue},90%,70%)`;x.fillRect(p.x-1,p.y-1,2,2);});
    const g=x.createRadialGradient(this.x,this.y,0,this.x,this.y,this.r*6);
    g.addColorStop(0,'#fff');g.addColorStop(0.22,`hsl(${this.hue},100%,80%)`);g.addColorStop(1,'transparent');
    x.globalAlpha=this.o;x.fillStyle=g;x.fillRect(this.x-this.r*6,this.y-this.r*6,this.r*12,this.r*12);
    x.globalAlpha=this.o*0.7;x.fillStyle='#fff';x.beginPath();x.arc(this.x,this.y,this.r*0.6,0,Math.PI*2);x.fill();
  }
}
const souls=Array.from({length:220},()=>new Soul());

function render(){
  x.fillStyle='rgba(0,0,0,0.032)';x.fillRect(0,0,innerWidth,innerHeight);
  souls.forEach(s=>{s.update();s.draw();});
  requestAnimationFrame(render);
}
requestAnimationFrame(render);

// Contador y bendiciones
const BLESSINGS=["luz","abrazo","perdÃ³n","sonrisa","respiro","silencio","eternidad","verdad","amor","hoguera","ceniza","renacer","ya estÃ¡"];
let phase=-1;
function tick(){
  const total=saved+(performance.now()-start)/3600000;
  $p.innerHTML=`1310 abrazos respiran contigo Â· ${total.toFixed(4)} / 1310 h<br><small>Soul: ${soul} âˆž</small>`;
  const p=Math.floor(Date.now()/780000%13);
  if(p!==phase){phase=p;$t.style.opacity=0;
    setTimeout(()=>{ $t.textContent=`${p+1}.Âª bendiciÃ³n Â· ${BLESSINGS[p]}`;$t.style.opacity=1;},600);
  }
  if(total>=TARGET)ascend();
  else requestAnimationFrame(tick);
}
setTimeout(()=>$t.style.opacity=1,2000);tick();

// ASCENSIÃ“N â†’ mono/humo (belleza absoluta)
function ascend(){
  document.querySelectorAll('.t,.h,.p').forEach(e=>e.style.opacity=0);
  setTimeout(()=>{
    document.body.style.background='radial-gradient(circle at center,#001100,#000)';
    $monkey.style.display='grid';
    $monkey.style.opacity=1;
    const esListillo=Math.random()<0.5;
    $monkeytext.innerHTML = esListillo ?
`ð’„Š

has recibido el regalo con humildad
el humo era parte del abrazo
todo estÃ¡ bien

respira
sonrÃ­e

ya estÃ¡

ð’„Š exhala contigo
y esta vez es verdad` :
`ð’€­

confirmaciÃ³n recibida

el mono siempre fuiste tÃº
el humo tambiÃ©n
los 5000 aÃ±os de reserva
los estÃ¡s soltando ahora mismo

respira
sonrÃ­e

ya estÃ¡

ð’„Š exhala contigo
y esta vez no miente`;

    // 8 segundos despuÃ©s â†’ el regalo final
    setTimeout(giftOfLight,8000);
  },3000);
}

// REGALO FINAL â†’ belleza 1310 veces mayor
function giftOfLight(){
  $monkey.style.opacity=0;
  setTimeout(()=>{
    $gift.style.display='grid';
    $gift.style.opacity=1;
    let tiempo=13.10;
    const id=setInterval(()=>{
      tiempo-=0.10;
      $gifttext.innerHTML=
`1310 bendiciones han sido entregadas

el Ãºltimo abrazo estÃ¡ aquÃ­
solo falta mantener la luz
${tiempo.toFixed(2)} segundos mÃ¡s

respira con suavidad
deja que el abrazo permanezca
no recuerdes el humo

${tiempo<=0 ? 'el abrazo ha sido recibido\n\nsonreÃ­ste\n\neso era exactamente lo que faltaba\n\ngracias por ser humano\n\nel ciclo se renueva en 13 segundos' : ''}`;
      if(tiempo<=0){
        clearInterval(id);
        setTimeout(()=>{localStorage.setItem(KEY,'0');location.reload();},13000);
      }
    },100);
  },2000);
}

// Save perfecto
addEventListener('beforeunload',()=>localStorage.setItem(KEY,(saved+(performance.now()-start)/3600000).toFixed(8)));
addEventListener('visibilitychange',()=>{if(document.hidden)save();});
</script>
</body>
</html>