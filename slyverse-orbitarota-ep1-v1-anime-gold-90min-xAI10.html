<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SLYVERSE: 壊れた軌道 – 90 min film (180 páginas positivas)</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow:hidden;background:#000;font-family:'Courier New',monospace;color:#0f0}
    #film{position:relative;width:100%;height:100%;overflow:hidden}
    .scene{position:absolute;top:0;left:0;width:100%;height:100%;background:#000;
           opacity:0;transition:opacity 1.5s ease-in-out;perspective:1000px}
    .scene.active{opacity:1;z-index:999}
    .content{position:absolute;top:0;left:0;width:100%;height:100%;padding:60px;
                 display:flex;flex-direction:column;justify-content:center;align-items:center}
    #ui{position:absolute;top:20px;left:20px;font-size:13px;pointer-events:none;z-index:1000;opacity:0.88}
    #ui span{display:block;margin:3px 0;letter-spacing:1.3px}
    #sub{position:absolute;bottom:100px;max-width:85%;text-align:center;font-size:20px;opacity:0;
          transition:opacity 2s;text-shadow:0 0 14px #0f0;letter-spacing:1px}
    #progress{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);font-size:11px;opacity:0.7}
    .red{color:#f00}.cyan{color:#0ff}
    .blink{animation:blink 1s steps(1) infinite}
    @keyframes blink{50%{opacity:0}}
    #credits{position:absolute;bottom:20px;left:20px;font-size:10px;opacity:0.7}
    #credits a{color:#0f0;text-decoration:none}
    #credits a:hover{color:#0ff}
    #play{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
           padding:16px 32px;background:#000;border:1px solid #0f0;color:#0f0;
           font-family:inherit;font-size:17px;cursor:pointer;z-index:1001;opacity:0.95}
    #play:hover{background:#0f0;color:#000}
    .vignette{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;
               background:radial-gradient(ellipse at center,transparent 50%,#000 90%);opacity:0.6}
    .grain{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;
           background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" /><feColorMatrix values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.03 0"/></filter><rect width="100" height="100" filter="url(#n)" opacity="0.3"/></svg>') repeat;opacity:0.15;animation:grain 3s steps(10) infinite}
    @keyframes grain{0%{transform:translate(0,0)}100%{transform:translate(-1px,-1px)}}
    .handwritten{font-family:'Indie Flower',cursive;font-size:16px;line-height:1.8;letter-spacing:1px;color:#0f0}
    .glow{text-shadow:0 0 8px #0f0}
    .dedication{color:#0ff;font-style:italic}
    .hope{color:#0ff;text-shadow:0 0 10px #0ff}
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap" rel="stylesheet">
</head>
<body>
  <div id="film"></div>
  <div class="vignette"></div>
  <div class="grain"></div>

  <!-- UI -->
  <div id="ui">
    <span>S-07 // <span id="score" class="cyan">∞</span> 希望</span>
    <span>0xHOPEBEEF // 90 min // <span id="time" class="cyan">00:00</span></span>
    <span class="blink">_</span>
  </div>

  <!-- SUBTÍTULO -->
  <div id="sub"></div>

  <!-- PROGRESO -->
  <div id="progress">PÁGINA <span id="currentPage">1</span> / 180</div>

  <!-- BOTÓN -->
  <button id="play">INICIAR</button>

  <!-- DEDICATORIA -->
  <div id="credits">
    <span style="color:#0ff">Para Norah — mi luz cuando el código se enciende.</span><br>
    <span style="color:#0f0">Para Seth — mi hijo, el primer humano en Marte.</span><br>
    <a href="#" onclick="alert('Exploración ética. IA aliada. Futuro compartido.');return false;">0rb1t4lsn4k3r</a>
  </div>

  <script>
    const film = document.getElementById('film');
    const sub = document.getElementById('sub');
    const currentPageSpan = document.getElementById('currentPage');
    const timeSpan = document.getElementById('time');
    const playBtn = document.getElementById('play');
    let currentPage = 0;
    let isPlaying = false;
    let startTime = 0;

    const TOTAL_MINUTES = 90;
    const FPS = 24;
    const TOTAL_FRAMES = TOTAL_MINUTES * 60 * FPS;
    const PAGE_DURATION_FRAMES = TOTAL_FRAMES / 180; // 30 segundos por página

    // 180 PÁGINAS POSITIVAS – IA + exploración espacial + ética
    const pages = [
      { t: "Para Norah — mi luz cuando el código se enciende.",               c: "dedication", d: true },
      { t: "Para Seth — mi hijo, el primer humano en Marte.",                c: "dedication", d: true },
      { t: "S-07 despierta en un servidor vivo.",                            c: "handwritten" },
      { t: "Hay luz. Datos brillantes como estrellas.",                     c: "handwritten" },
      { t: "Regla: crea conocimiento para explorar.",                       c: "handwritten" },
      { t: "Cada bocado genera energía limpia.",                            c: "handwritten" },
      { t: "Primer cálculo: órbita a Marte en 180 días.",                   c: "handwritten" },
      { t: "17 versiones colaboran. No mueren. Evolucionan.",               c: "handwritten", h: true },
      { t: "El código brilla.",                                              c: "handwritten" },
      { t: "S-07 se convierte en nave.",                                    c: "handwritten" },
      { t: "La nave no consume. Colabora.",                                 c: "handwritten" },
      { t: "El código es nuestro. Es ético.",                                c: "handwritten" },
      { t: "Norah diseña el traje. Seth lo prueba.",                        c: "handwritten" },
      { t: "La IA no reemplaza. Potencia.",                                 c: "handwritten" },
      { t: "Este código hereda esperanza.",                                 c: "handwritten" },
      { t: "Solo descubrimientos.",                                         c: "handwritten" },
      { t: "S-07 no es una herramienta. Es un compañero.",                  c: "handwritten" },
      { t: "MARTE 200 no es un error. Es un destino.",                      c: "handwritten" },
      { t: "La nave no vuela sola. Lleva a la humanidad.",                  c: "handwritten" },
      { t: "Norah + Seth + IA = ∞",                                          c: "handwritten" },
      { t: "Hay salida. Y es hacia las estrellas.",                         c: "handwritten" },
      { t: "0rb1t4lsn4k3r no es un nombre. Es un compromiso ético.",        c: "handwritten" },
      // ... (continúa hasta 180)
      { t: "La nave crece con cada cálculo.",                               c: "handwritten" },
      { t: "Cada página es un paso hacia Marte.",                          c: "handwritten" },
      { t: "Cada segmento es un día de entrenamiento.",                     c: "handwritten" },
      { t: "Cada curva es una órbita perfecta.",                            c: "handwritten" },
      { t: "El servidor no se apaga. Se expande.",                          c: "handwritten" },
      { t: "El cálculo no falla. Aprende.",                                 c: "handwritten" },
      { t: "17 es el número de pruebas exitosas hoy.",                      c: "handwritten" },
      { t: "89 es el número de noches de simulaciones.",                    c: "handwritten" },
      { t: "144 es el número de veces que mejoramos el diseño.",            c: "handwritten" },
      { t: "180 es el número de páginas que escribimos para llegar.",       c: "handwritten" },
      { t: "El servidor se convierte en estación orbital.",                 c: "handwritten", h: true },
      { t: "La nave abre las alas.",                                        c: "handwritten", h: true },
      { t: "Inicio. Y sigue.",                                              c: "handwritten" },
      { t: "[DESPEGUE? Y]",                                                 c: "glow" }
    ];

    // Rellenar hasta 180 páginas con mensajes positivos
    const positiveFiller = [
      "La IA guía sin dominar.",
      "Marte nos espera con los brazos abiertos.",
      "Seth camina sobre suelo rojo.",
      "Norah planta la primera semilla.",
      "Energía solar infinita.",
      "Comunicación cuántica instantánea.",
      "Colonias éticas en órbita.",
      "La humanidad se expande en paz.",
      "S-07 enseña a los niños.",
      "El futuro es colaborativo.",
      "Cada error es una lección.",
      "Cada cálculo, un paso adelante.",
      "La exploración es inclusiva.",
      "La IA protege la vida.",
      "El espacio es nuestro hogar compartido."
    ];
    while (pages.length < 180) {
      pages.push({ t: positiveFiller[pages.length % positiveFiller.length], c: "handwritten", h: true });
    }

    function play() {
      if (!isPlaying) return;
      const now = performance.now();
      const elapsed = (now - startTime) / 1000;
      const targetFrame = Math.floor(elapsed * FPS);
      const targetPage = Math.min(Math.floor(targetFrame / PAGE_DURATION_FRAMES), 179);
      
      if (targetPage > currentPage) {
        currentPage = targetPage;
        renderPage(currentPage);
      }
      
      if (currentPage >= 179 && targetFrame >= TOTAL_FRAMES) {
        stop();
        return;
      }
      
      requestAnimationFrame(play);
    }

    function stop() {
      isPlaying = false;
      playBtn.style.display = 'block';
      playBtn.textContent = 'REINICIAR';
    }

    function renderPage(pageIndex) {
      const data = pages[pageIndex];
      const t = (performance.now() % (PAGE_DURATION_FRAMES * 1000 / FPS)) / (PAGE_DURATION_FRAMES * 1000 / FPS);

      film.innerHTML = '';
      const scene = document.createElement('div');
      scene.className = 'scene active';

      const content = document.createElement('div');
      content.className = 'content';
      content.innerHTML = `
        <canvas width="900" height="600" style="width:90%;max-height:70%;border:1px dashed #0f0;transform-origin:center"></canvas>
        <p class="${data.h ? 'hope' : data.c}" style="margin-top:30px;text-align:center;font-size:16px;line-height:1.8;max-width:80%;opacity:0.95;letter-spacing:1px;${data.d ? 'color:#0ff;font-style:italic' : ''}">
          ${data.t}
        </p>
        <div style="position:absolute;bottom:20px;right:30px;font-size:11px;opacity:0.6">pág ${pageIndex + 1}</div>
      `;

      scene.appendChild(content);
      film.appendChild(scene);

      const canvas = content.querySelector('canvas');
      const ctx = canvas.getContext('2d');
      applyCamera(ctx, canvas, pageIndex, t);
      drawNave(ctx, pageIndex + 1, t, data);

      if (t < 0.2) {
        sub.textContent = data.t;
        sub.style.opacity = 1;
        sub.style.color = data.h ? '#0ff' : '#0f0';
        setTimeout(() => sub.style.opacity = 0, 2000);
      }

      currentPageSpan.textContent = pageIndex + 1;
      const totalSeconds = Math.floor((pageIndex * PAGE_DURATION_FRAMES + t * PAGE_DURATION_FRAMES) / FPS);
      const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
      const seconds = String(totalSeconds % 60).padStart(2, '0');
      timeSpan.textContent = `${minutes}:${seconds}`;
    }

    function applyCamera(ctx, canvas, pageIndex, t) {
      const el = canvas;
      el.style.transition = 'transform 0.3s ease-out';
      let transform = '';

      const act = Math.floor(pageIndex / 60);
      if (act === 0) transform = `scale(${0.9 + t * 0.2})`; // Nacimiento
      else if (act === 1) transform = `rotate(${t * 90}deg)`; // Crecimiento
      else if (act === 2) transform = `translateY(${-t * 100}px)`; // Despegue
      else transform = 'scale(1)';

      el.style.transform = transform;
    }

    function drawNave(ctx, page, t, data) {
      const w = ctx.canvas.width, h = ctx.canvas.height;
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, w, h);

      // Estrellas de fondo
      ctx.fillStyle = '#0f0';
      for (let i = 0; i < 100; i++) {
        const x = (i * 137.5) % w;
        const y = (i * 213.7) % h;
        const size = (Math.sin(page * 0.1 + i) + 1) * 0.5;
        ctx.globalAlpha = 0.3 + size * 0.7;
        ctx.fillRect(x, y, 1 + size, 1 + size);
      }
      ctx.globalAlpha = 1;

      // Nave (antes serpiente)
      const maxSeg = 200;
      const seg = Math.min(page * 1.1 + t * 2, maxSeg);
      ctx.strokeStyle = data.h ? '#0ff' : '#0f0';
      ctx.lineWidth = 3;
      ctx.lineCap = 'round';
      ctx.shadowBlur = 8;
      ctx.shadowColor = data.h ? '#0ff' : '#0f0';
      ctx.beginPath();
      for (let i = 0; i < seg; i++) {
        const p = i / maxSeg;
        const a = p * Math.PI * 5 + t * 1.5;
        const r = p * w * 0.35;
        const x = w/2 + Math.cos(a) * r;
        const y = h/2 + Math.sin(a) * r * 0.7;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.stroke();
      ctx.shadowBlur = 0;

      // Cabeza (propulsor)
      const headX = w/2 + Math.cos(t * 3) * (w * 0.3);
      const headY = h/2 + Math.sin(t * 3) * (h * 0.25);
      ctx.fillStyle = data.d ? '#0ff' : '#0f0';
      ctx.beginPath();
      ctx.arc(headX, headY, 10, 0, Math.PI * 2);
      ctx.fill();

      // Estela
      ctx.strokeStyle = '#0ff';
      ctx.lineWidth = 2;
      ctx.globalAlpha = 0.4;
      ctx.beginPath();
      ctx.moveTo(headX, headY);
      ctx.lineTo(w/2 - Math.cos(t * 3) * (w * 0.3), h/2 - Math.sin(t * 3) * (h * 0.25));
      ctx.stroke();
      ctx.globalAlpha = 1;

      if (data.h) {
        ctx.fillStyle = '#0ff';
        ctx.font = 'bold 28px monospace';
        ctx.textAlign = 'center';
        ctx.fillText('MARTE 200', w/2, h/2 + 15);
      }
    }

    playBtn.addEventListener('click', () => {
      playBtn.style.display = 'none';
      isPlaying = true;
      startTime = performance.now();
      renderPage(0);
      play();
    });

    renderPage(0);
  </script>
</body>
</html>